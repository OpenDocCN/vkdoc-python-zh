# 一、什么是描述符？

简而言之，描述符是一个类，可用于调用具有简单属性访问的方法，但显然不止于此。如果不深入研究描述符是如何实现的，就很难解释这一点。这是描述符协议的高级视图。

描述符至少实现了以下三种方法之一:`__get__()`、`__set__()`或`__delete__()`。这些方法中的每一个都有一个需要的参数列表，这将在稍后讨论，并且每一个都由描述符所表示的属性的不同类型的访问来调用。做简单的`a.x`访问会调用`x`的`__get__()`方法；使用`a.x = value`设置属性将调用`x`的`__set__()`方法；并且使用`del a.x`将调用`x`的`__delete__()`方法。

### 注意

从 3.6 版本开始，描述符可以利用另一种方法，叫做`__set_name__()`，但是仅仅使用这种方法并不能像其他三种方法一样使它成为描述符。这种方法在一段时间内会被忽略，因为它对描述符的工作方式没有太大的影响。它只会在最相关的地方被提及。

如上所述，为了被认为是描述符，只需要实现其中一个方法，但是可以实现任意数量的方法。此外，根据描述符类型和实现的方法，不实现某些方法会限制某些类型的属性访问或为它们提供有趣的替代行为。根据实现这些方法的集合，有两种类型的描述符:数据和非数据。

## 数据描述符与非数据描述符

一个数据描述符至少实现了`__set__()`或`__delete__()`，但也可以同时包含两者。数据描述符通常还包括`__get__()`，因为很少想要设置某个东西而又不能获取它。你*可以*得到值，即使描述符不包含`__get__()`，但是要么是迂回的，要么是描述符把它写到实例中。这将在后面详细讨论。

非数据描述符*只有*实现`__get__()`。如果它添加了一个`__set__()`或`__delete__()`方法，它就变成了一个数据描述符。

不幸的是，PyPy 解释器(直到版本 2.4.0)在这一点上有点错误。直到它知道`__delete__()`是一个数据描述符，它才考虑它，PyPy 不相信某个东西是数据描述符，除非`__set__()`被实现。幸运的是，由于绝大多数数据描述符都实现了`__set__()`，这很少成为问题。

这种区别似乎毫无意义，但事实并非如此。它在属性查找时发挥作用。这将在后面详细讨论，但基本上，区别在于它提供的使用类型。

## Python 对描述符的使用

值得注意的是，描述符是 Python 工作方式的固有部分。众所周知，Python 是一种多范式语言，因此支持函数式编程、命令式编程和面向对象编程等范式。本书并不试图深入探讨不同的范式；将只观察面向对象的编程范例。描述符在 Python 中被隐式地用于该语言的面向对象机制。正如将要解释的，方法是使用描述符实现的。正如你可能从阅读这篇文章中猜到的，正是由于描述符，在 Python 中面向对象编程成为可能。描述符非常强大和先进，这本书旨在教 Python 程序员如何充分使用它们。

## 摘要

正如您所看到的，描述符占据了 Python 语言的很大一部分，因为它们可以用方法调用代替属性访问，甚至可以限制允许哪些类型的属性访问。现在，您对描述符是如何实现的以及语言对它们的使用有了一个大致的了解，我们将会更深入地挖掘，更好地理解它们是如何工作的。