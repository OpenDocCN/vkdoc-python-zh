# 七、Linux 基础

在本章中，您将学习 Linux 基础知识，以便快速掌握在第八章中学习的基本 Linux 管理技能。因为您可能已经从事网络自动化工作，所以您不必成为全职的 Linux 管理员。然而，您必须知道您在这些系统上正在做什么，这样您就不会停止运行在 enterprise Linux 系统上的关键服务。其他 Python 网络自动化书籍经常忘记提及一般 Linux 管理技能对于网络自动化的重要性。事实上，Linux 和 Python 网络自动化是齐头并进的。

在这一章中，你将学习如何开始使用 Linux，以及关于目录和文件结构。然后您将学习使用 vi 和 nano 进行基本的文件和目录管理。本章结束时，你将能够使用 Linux 终端和文本编辑器来管理目录和文件。

![img/492721_1_En_7_Figa_HTML.jpg](img/492721_1_En_7_Figa_HTML.jpg)本章没有安装前任务，但本章假设您已经阅读并完成了第 1–3 章节。您将使用之前章节中安装的 Ubuntu Server 20 LTS 和 CentOS 8.1 虚拟服务器。如果您尚未完成这些安装，请返回到前面的章节并创建您的虚拟机。您可以从以下 GitHub 网站下载其他安装指南:

URL: [`https://github.com/pynetauto/apress_pynetauto`](https://github.com/pynetauto/apress_pynetauto)

在本章中，您将使用 CentOS 8.1 和 Ubuntu Server 20 LTS 虚拟机学习 Linux 基础知识。图 7-1 显示了本章所需的逻辑实验拓扑。您需要启动并运行两个 Linux 服务器，通过 VMnet8 (NAT)网络连接，并且您的 Windows 主机连接到互联网。VMnet8 网络子网的第三个二进制八位数可能与图中所示的不同。如果是这样，您将在给定的子网内工作，或者您可以从 VMware Workstation 的虚拟网络编辑器中更新 VMnet8 子网，使该子网也位于 192.168.183.0/24 子网中。

![img/492721_1_En_7_Fig1_HTML.jpg](img/492721_1_En_7_Fig1_HTML.jpg)

图 7-1。

逻辑网络拓扑

## 为什么要学 Linux？

本章致力于学习 Linux 基础知识。您将了解 Linux 的历史、不同类型的 Linux 发行版、基本的文件和目录管理，以及如何使用 vi/nano 文本编辑器进行基本的 Linux 管理。您可能是一个内容 Windows 用户，或者问“为什么 IT 技术人员应该学习 Linux？”或者“为什么有人要学 Linux？”我对这个问题的简单回答是，作为一个 IT 技术人员学习 Linux 没有什么损失；这包括网络、安全、系统和软件工程师等。目前的 IT 行业缺乏拥有良好 Linux 管理技能的 IT 工程师，这表明如果你既懂 Linux 又懂 Windows 管理，那么会有很多工作机会。

直截了当地说，从微软 Windows 用户的角度来看，试图驯服和掌握 Linux 操作系统(OS)并平稳过渡到 Linux 是一条崎岖的道路。对许多人来说，失去 Windows 或图形用户界面(GUI)是一件大事。如果你已经精通 Linux，那就太棒了；你领先了一步，而且是当之无愧的领先。大约 20 年前，当我得到我的第一份 IT 支持工作时，我遇到了一位导师，他建议我对 Linux 感兴趣，然后从事 Linux 管理员的职业。当时，我对思科网络、统一通信和 Windows 更感兴趣，所以我没有找到一个令人信服的理由认真学习 Linux。直到 2015 年，我才开始对 Python 编码产生兴趣。我意识到我有多后悔没有接受以前导师的建议去学习 Linux。在我们的行业中，很多 IT 工程师，尤其是网络工程师，都会犯同样的错误。我现在和其他 Windows 用户分享我的故事，这样他们就能对 Linux 保持开放的心态。不要错过这个机会。

至少在企业级，很大一部分应用服务器运行在某种基于 Linux 的操作系统上。它可能是亚马逊网络服务(AWS)或云中的脸书或谷歌；应用服务器需要一个安全可靠的操作系统来日复一日地运行。在过去的 15 年中，Linux 服务器的使用量与云的使用量同步大幅增长，大数据业务也获得了发展势头。多年来，在企业 IT 和数据中心环境中，越来越多的企业系统从 Windows 迁移到 Linux。这一趋势背后有许多原因，但仅举几个例子，Linux 提供了更高的性价比；它具有更好的可靠性、安全性、可扩展性、高可用性和灵活性，这是 Windows server 环境所不具备的。Linux 现在是我们生活方式的新标准。2020 年，微软发布了 Windows 10 补丁，内置了 Linux 内核支持，支持 Windows Subsystem for Linux (WSL)。所以，现在你甚至可以在 Windows 上运行 Linux 虚拟机。

![img/492721_1_En_7_Figb_HTML.gif](img/492721_1_En_7_Figb_HTML.gif)访问 Microsoft Windows 文档网站，阅读有关 WSL 的更多信息。

URL: [`https://docs.microsoft.com/en-us/windows/wsl/install-win10`](https://docs.microsoft.com/en-us/windows/wsl/install-win10)

如果您已经在企业网络行业工作了一段时间，那么您将对思科技术最为熟悉。仅以思科为例，大约 20 年前，思科的大部分网络、安全和语音服务应用都基于 Windows 2000 和 2003。一个很好的例子是 Cisco 的 IP PABX 服务器，称为 Cisco CallManager(版本 3 和 4.1)，它是建立在 Windows 2000 服务器上的。其他例子包括旧的 UCCX、UCCE 和 CiscoWorks 服务器；他们都使用 Windows 服务器作为基础平台。然而，在 2010 年，思科决定放弃 Windows 服务器，转而采用设备模式；它将其许多应用服务器迁移到基于 Red Hat 的 Linux 操作系统(OS)上。甚至在 2010 年之前，思科放弃 Windows 服务器并用 Linux 取而代之的决定就符合 IT 趋势。此外，在 Juniper 的核心操作系统中可以找到 Linux 操作系统的改编版本，如 Junos 和 Palo Alto 的 PAN 产品；它们都使用 Linux 作为基本操作系统。

如前所述，Linux 相对于 Windows 的一些优势包括稳定性、高安全性和较低的拥有成本。Linux 是一个有效的企业操作系统，所有 IT 工程师都必须学习并应用到他们的工作中。并不是所有人都真的想以 Linux 系统管理员为生，但是我们必须知道足够多的知识来保住我们作为 IT 技术人员的工作。在本书中，您希望学习足够的 Linux 基础知识，以便能够轻松地执行基本的实验任务。如果你打算专业学习 Linux 成为一名 Linux 系统管理员，可以系统学习红帽 8 认证。在本书中，我们将学习精选的 Linux 资料，以便开始学习 Python 网络自动化。

要了解一项技术，从一点历史或者它的起源开始总是好的。让我们从一些 Linux 历史开始，了解我们可用的不同类型的 Linux 发行版，研究 Linux 文件和目录结构，并掌握 vi 和 nano 文本编辑器，以便在没有图形用户界面(GUI)帮助的情况下完成工作。但是万一你因为某种原因需要一个 GUI，我们已经在我们的服务器上有了可选的基于 GUI 的 Linux 桌面。在本章的最后，你需要在 Ubuntu 和 CentOS Linux 服务器上执行一些基本的管理。

## Linux 的开始

为了理解 Linux，让我们快速回顾一下 Linux 的早期历史，然后回顾一下当今最流行的 Linux 发行版。供您参考，表 7-1 中的时间表只显示了直到 1991 年第一个 Linux 发行版发布之前的最初开发亮点。如果您想找到其他时间线，请参考 [`https://en.wikipedia.org/wiki/Linux`](https://en.wikipedia.org/wiki/Linux) 。

表 7-1。

早期 Linux 开发时间表

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"></colgroup> 
| 

年

 | 

Linux 开发亮点

 |
| --- | --- |
| One thousand nine hundred and sixty-nine | 与 Ken Thompson、Dennis Ritchie、Douglas Mcilroy 和 Joe Ossanna 在美国电话电报公司实验室首先开发了 UNIX。 |
| One thousand nine hundred and seventy-one | Unix 最初是用汇编语言编写的。 |
| One thousand nine hundred and seventy-three | Dennis Richie 首先使用 C 语言编写了 UNIX。 |
| One thousand nine hundred and eighty-three | 理查德·斯托尔曼引入了 GNU 项目。 |
| One thousand nine hundred and eighty-four | 完整的 UNIX 兼容软件系统。自由软件开发开始了。 |
| One thousand nine hundred and eighty-five | 理查德·斯托尔曼建立自由软件基金会。 |
| One thousand nine hundred and eighty-nine | 引入了通用公共许可证(GNU)。 |
| One thousand nine hundred and ninety | 许多程序是为操作系统开发的。 |
| 1991 年 8 月 25 日 | 当时 21 岁的芬兰学生林纳斯·本纳第克特·托瓦兹公开宣布 Linux 内核的免费版本。1991 年的 Linux 内核是在 GNU GPL 许可下发布的。 |

来源: [`https://en.wikipedia.org/wiki/Linux`](https://en.wikipedia.org/wiki/Linux)

从表 7-1 可以看出，Linux 植根于 UNIX。我们可以猜测，Linux 的语法和操作将与 UNIX 相似。自从 Linus Torvalds 在 1991 年发布免费的 Linux 内核以来，许多 Linux 发行版都是在 GNU 下开发和发布的。有些 Linux 类型是商业驱动的，有些是为社区或个人使用而创建的。大多数 Linux 发行版可以运行商业应用，但也有一些提供了很好的桌面版本，如 Ubuntu desktop。

表 7-2 列出了 2017 年以来最流行的十个 Linux 发行版，以及每个 Linux 类型的一些特征。如果您的企业基础设施需要 Linux 操作系统，最推荐的 Linux 系统是 Red Hat Enterprise Server。如果你必须用它来工作和学习，Ubuntu、CentOS 和 Debian 是非常灵活和用户友好的 Linux 发行版。在这三个非常流行的 Linux 发行版中，Ubuntu 具有最用户友好的特性，如果需要的话，它有一个很棒的 GUI，是初学者的绝佳选择。注意 Ubuntu 是 Debian 的衍生品。CentOS 使用与 Red Hat 和 Fedora 相同的 Linux 内核和软件。这里提到的三个 Linux，Red Hat、CentOS 和 Fedora，都是相同的 Linux 发行版，只是在美学上稍有不同。Fedora 是 Red Hat 的开发版本。红帽是面向大型企业的企业级商业化 Linux，CentOS 是红帽的开源版本。Fedora 提供最新的测试版软件，但缺乏 CentOS 和 Red Hat Linux 的稳定性。因此，在学习 Linux 时，任何版本的 CentOS server 或 CentOS Stream 都应该是 Red Hat 衍生的 Linux 版本的首选 Linux 发行版。Linux 开源版本和商业版本之间的主要区别在于，您是从供应商支持团队获得全面的技术支持，还是从 Linux 开发人员社区获得尽最大努力的支持。现在快速查看表 7-2 并找到您想要使用的 Linux 发行版。大多数 Linux 软件对个人使用是免费的，没有商业限制。

表 7-2。

2017 年十大 Linux 服务器发行版

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"> <col class="tcol3 align-left"> <col class="tcol4 align-left"> <col class="tcol5 align-left"></colgroup> 
| 

军阶

 | 

Linux 在这里

 | 

OS 衍生物

 | 

用户技能水平

 | 

优势

 |
| --- | --- | --- | --- | --- |
| one | Ubuntu 服务器 | 基于 Debian 的 | 中间的 | 性能、稳定性、灵活性、DC 支持、安全 |
| Two | 红帽企业 Linux (RHEL) | 基于 Fedora 的 | 先进的 | 供应商支持、性能、安全、云和物联网支持、数据和虚拟化支持 |
| three | 企业服务器 | 基于 RPM | 中间的 | 开源、稳定、安全的云服务支持 |
| four | CentOS | 总部设在 RHEL | 中间的 | 免费社区支持；与没有标志的 RHEL 相同 |
| five | 一种自由操作系统 | 基于 Debian 的 | 中级到高级 | 免费，开源，稳定，教育，商业，政府和非政府组织可以使用 |
| six | Oracle Linux(Oracle 企业 Linux) | 总部设在 RHEL | 先进的 | 免费、开源、云外、中小型企业和企业使用、云和数据中心支持 |
| seven | Mageia | 基于 Mandriva 的 | 中间的 | 免费、稳定、安全、社区支持、一系列软件、MariaDB 支持 |
| eight | 克利罗斯 | 总部设在 RHEL/CentOS | 中级到高级 | 开源、SMB 支持、商业用途、网络网关和服务器支持、web 服务器支持 |
| nine | Arch Linux | 其他的 | 先进的 | 开源、简单、性能优化、稳定、灵活 |
| Ten | slackware | 基于 Slackware | 先进的 | 免费，开源，最接近的 UNIX 系统，简单，稳定 |

来源: [`https://www.tecmint.com/10-best-linux-server-distributions/`](https://www.tecmint.com/10-best-linux-server-distributions/)

## 了解 Linux 环境

Linux 是安装在物理或虚拟机上用于个人或商业用途的操作系统(OS)。Linux 桌面和 Linux 服务器的显著区别是图形用户界面。Linux 服务器通常被安装来为用户或企业提供特定的服务，并且通常由精通 Linux 命令的 Linux 管理员来管理。为了获得更好的性能、稳定性和更高的安全性，Linux 通常会安装最低版本的软件。除此之外，Linux 桌面和服务器版本对 Linux 操作系统的每个发布版本使用相同的基本内核。如前几章所示，您可以选择在 Linux 服务器上安装 GUI。在本书的前面，为了学习和方便，您在 Linux 服务器上安装了一个桌面。随着您对 Linux 及其命令行的熟悉，您将慢慢脱离 GUI，能够仅使用命令行运行所有基本的 Linux 管理任务。你会发现，在 Linux 中，一切都是由文件和目录组成的；这是一个免费且非常灵活的操作系统。同样，如果您习惯于通过命令行界面(CLI)来管理 Cisco 设备，那么您会有宾至如归的感觉。即使你没有思科网络背景或零 Linux 经验，你也能跟上；我们将只讨论 Linux 的基础知识，这样您就可以运行实验来结束您的第一次 Python 网络自动化之旅。

## 了解 Linux 目录和文件格式

前面，我们简要地看了一下 Linux 开发时间表，了解了流行的 Linux 发行版类型。接下来，让我们快速看一下 Linux 目录结构。在 Linux 中，所有的东西都是用文本写的，保存在不同的目录中。由于 Windows 操作系统也可以追溯到*nix，所以 Windows 文件和文件夹结构是相似的。但是 Linux 不像 Windows 一样有`C:`驱动；相反，它有根文件夹，或者说`/.`图 7-2 描述了一个通用的 Linux 目录结构以及每个目录中通常存放的文件类型。当然，您可以像在 Windows 操作系统中一样创建自定义目录和文件。如果您忘记了每个目录的用途，请查看该图并将其作为参考点。这个阶段不用全部背下来，但是看一看，看能不能发现什么有趣的东西。

![img/492721_1_En_7_Fig2_HTML.jpg](img/492721_1_En_7_Fig2_HTML.jpg)

图 7-2。

典型的 Linux 目录和文件结构

![img/492721_1_En_7_Figc_HTML.gif](img/492721_1_En_7_Figc_HTML.gif)图 7-2 显示了一个典型的 Linux 目录结构。不同的 Linux 类型会有稍微不同的目录和文件结构，但是通常彼此是相同的。

图 7-3 显示了 CentOS 8 服务器的根目录。仔细查看并比较列出的目录；你会看到与图 7-2 的相似之处。

![img/492721_1_En_7_Fig3_HTML.jpg](img/492721_1_En_7_Fig3_HTML.jpg)

图 7-3。

CentOS 8 Linux 目录示例

## 虚拟化与纳米化

您已经简要了解了典型的 Linux 目录和文件结构。现在让我们考虑一下 Linux 文件和目录管理。已经具备良好 Linux 知识的读者会问:“为什么在这里教如何使用 vi 文本编辑器？”如果你是一个经验丰富的 Linux 用户，你可以跳过这一章的大部分内容，但是在继续阅读第九章之前，请务必阅读第八章，以便在 CentOS 8.1 服务器上安装各种 ip 服务。如果你对 Linux 接触不多，在跳到下一章之前，一定要学习 vi(可视化编辑器)和 nano。您需要熟悉 Linux 文本编辑器，并通过终端控制台或命令行执行大多数任务。在 Linux 服务器上，几乎所有的东西都是由文本文件组成的，您应该使用终端控制台来管理您的日常任务。换句话说，您必须通过命令行熟悉 Linux 文件结构、文件和目录管理。通常，当你在 Linux 服务器上执行一个任务时，你的意图必须是明确的，你确切地知道你想从你的行动中达到什么目的。学习使用 Linux 的文本编辑器对于学习 Python 来说是必不可少的，因为基于脚本的编码需要在您最喜欢的文本编辑器中花费很多时间。

当然，Linux 有各种各样的文本编辑器，但是大多数现代 Linux 系统上的标准文本编辑器是 vi。要想精通 Linux，学习如何使用它不是可有可无的，而是必须的。是的，vi 在黑色背景上缺少用户控件，对于第一次使用 Linux 的用户来说可能有些笨拙。让我们一劳永逸地学习如何使用 vi 编辑器，这样你就不必担心再次学习这个可怕的文本编辑器(无论如何，最初是可怕的)。

在本章中，我们鼓励您使用 vi 和一个名为 nano 的辅助文本编辑器来探索文件和目录管理。这是另一个最适合初学者的 Linux 文本编辑器，因为它使用伪图形布局。与 vi 不同，它不是预装在所有的 Linux 发行版上，但是了解这两者是有好处的。如上所述，学习如何使用 vi 不是可选的。在客户的生产环境中管理企业服务器和网络设备时，它可能是唯一可用的文本。

首先，让我们学习如何使用 vi 文本编辑器，它将成为您选择的主要 Linux 文本编辑器，然后您将学习如何使用 nano 文本编辑器作为您选择的第二个文本编辑器。

### vi 简介

我们可以说，Linux 中的 vi 源于 UNIX 中的 vi。Linux 中的 vi 与 UNIX 操作系统中的 vi 几乎相同，因此很清楚 Linux OS 及其应用的起源。首先，vi(“可视化编辑器”)通过将命令和插入模式分开，使用 to 模式来防止无意的编辑。在 vi 中有两种操作模式。

*   *命令模式*:这是第一次打开文件的起点。在这种模式下，输入的每个字符都是一个命令，用来改变正在打开的文本文件。

*   *插入模式*:这是编辑模式。在这种模式下，键入的每个字符都被添加到文件的文本中；按 Esc 键关闭插入模式并返回命令模式。

第二，在命令模式下，vi 有许多有用的命令，但是您只需要几个命令就可以开始了。表 7-3 包含基本但最有用的 vi 命令。经过一些练习，你的手指会比你的大脑先记住这些命令。

表 7-3。

vi 文本编辑器基本命令

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"> <col class="tcol3 align-left"></colgroup> 
| 

Vi 命令

 | 

描述

 |
| --- | --- |
| 基本的 | `vi` | 打开 vi 文本编辑器 |
| `i` | 进入插入模式 |
| 转义字符 | 退出插入模式 |
| `:x` | 退出 vi 而不保存更改 |
| `:q`或`:q!` | 退出或强行退出 |
| `:w` | 写 |
| `:wq`或`:wq!` | 保存并退出 |
| 移动 | `j` | 将光标下移一行 |
| 8 键 |
| $ key |
| `k` | 将光标上移一行 |
| #键 |
| `h` | 将光标向左移动一个字符 |
| 退格键 |
| ！键 |
| `l`(小写 L) | 将光标向右移动一个字符 |
| 空格键 |
| “钥匙 |
| 0(零) | 将光标移动到当前行的开头(光标行) |
| `$` | 将光标移动到当前行的末尾 |
| `w` | 将光标移动到下一个单词的开头 |
| `b` | 将光标移回到前一个单词的开头 |
| `:0` | 将光标移动到文件中的第一行 |
| `:n` | 将光标移动到第 n 行 |
| `:$` | 将光标移动到文件的最后一行 |
| 复制/粘贴 | `dd` | 复制(剪切) |
| `p` | 在光标下粘贴 |
| `P` | 粘贴到光标上方 |
| 取消 | `u` | 撤消最后的更改，一个简单的切换 |
| 搜索文本 | `/string` | 向前搜索文本中出现的字符串 |
| `?string` | 向后搜索文本中出现的字符串 |
| `n` | 移动到搜索字符串的下一个匹配项 |
| `N` | 以相反方向移动到搜索字符串的下一个匹配项 |

如果你已经浏览了表 7-3 大约五次，并且记住了 vi 的一些关键命令，现在你可以在 Ubuntu 或 CentOS 服务器中打开 VMware Workstation 和 SSH，为本章的第一个练习做准备(图 7-4 )。在真实的生产环境中，系统管理员通常使用 Putty、Tera Term 或 SecureCRT 等 SSH 客户端远程连接到 Linux 服务器和网络设备。您更喜欢使用哪个 Linux 服务器并不重要。尽管我们是在一台计算机上工作，但是请把您的服务器想象成一个远程 Linux 服务器，把您的主机的 Windows 操作系统想象成远程客户机。让我们练习一些基本的 vi 和 Linux 命令。

![img/492721_1_En_7_Fig4_HTML.jpg](img/492721_1_En_7_Fig4_HTML.jpg)

图 7-4。

使用 PuTTY 通过 SSH 登录 CentOS 8.1

#### 虚拟仪器基础

对一些人来说，学习如何使用 vi 可能是 Linux 的第一个障碍，但对其他人来说，vi 只是他们必须获得的另一个工具，这样他们就可以自豪地把它挂在腰带上。随着实践的进行，您将熟悉 vi，并且离开发良好的 Linux 管理技能更近了一步。

在输入每个 Linux 命令后，你必须按下键盘上的回车键。在练习的某些部分，您必须按回车键，您可能会看到左箭头(↲)符号。

这里有一个例子:`:wq` (↲).

前面的例子意味着在你输入`:wq`后，你必须按回车键。

在下面的练习中，用户使用用户名`pynetauto`通过 SSH 连接登录 CentOS 8.1 服务器。

1.  查看当前工作目录(`pwd`)，制作一个名为`ex_vi`的工作目录(`mkdir`，列出当前工作文件夹中的(`ls`)文件和目录，将目录(`cd`)更改为`ex_vi`目录。最后，再次检查当前工作目录(`pwd`)。

    目标:学习如何检查、创建和导航到一个新目录。

    `---------------------------------------------------------------------`

    `[pynetauto@localhost ~]$ pwd`

    `/home/pynetauto`

    `[pynetauto@ localhost ~]$ ls`

    `Desktop Documents Downloads Music Pictures Public Templates Videos`

    `[pynetauto@ localhost ~]$ mkdir ex_vi`

    `[pynetauto@ localhost ~]$ ls`

    `Desktop  Downloads Music   Public   Videos`

    `Documents ex_vi   Pictures Templates`

    `[pynetauto@ localhost ~]$ cd ex_vi`

    `[pynetauto@ localhost ex_vi]$ pwd`

    `/home/pynetauto/` `ex_vi`

    `---------------------------------------------------------------------`

2.  当文本文件在 vi 中打开时，您会注意到这是一个合适的极简文本编辑器。vi 最令人兴奋的地方是显示在应用底部的关于文件名和行号的信息。试着在键盘上敲点什么；您不能在命令模式下键入任何内容。转到下一个练习，将数据(文本)添加到该文件中。

    您可以通过键入`vi filename`然后按回车键来创建一个新文件。

    目标:学习如何创建/打开文件。

    `---------------------------------------------------------------------`

    `[pynetauto@localhost ex_vi]$ vi myfile01.txt`

    `---------------------------------------------------------------------`

    当新文件打开时，您会看到空行，每行都有一个波浪号(`~`)，并且在底部有一行显示新文件的文件名和状态。

    `---------------------------------------------------------------------`

    `~`

    `~`

    `~`

    `"myfile01.txt" [New File]             0,0-1     All`

    `---------------------------------------------------------------------`

3.  如果要在文本文件中输入文本，必须首先进入插入模式。首先，按下键盘上的 I 键进入`-- INSERT --`模式。如果您在左下角看到`--INSERT--`，那么 vi 现在已经准备好接受您的输入了。

    目标:学习如何在 vi 中进入插入模式。

    按下键盘上的 I 键。

    `---------------------------------------------------------------------`

    `~`

    `~`

    `~`

    `-- INSERT --                    0,1      All`

    `---------------------------------------------------------------------`

4.  现在，在这个文件中键入一些文本，然后按键盘上的 Esc 键退出插入模式并返回到命令模式。一按 Esc 键，就看左下角。`-- INSERT --`从屏幕上消失，你处于 Ex 模式。现在输入`:wq`或`:wq!`并按下输入↲键保存更改并退出 vi。

    目标:学习如何在 vi 中通过按`:wq` ↲来编写、保存和退出文件

    `Python lives in the jungle.`

    `Also, python lives on my computer` `.`

    `Have a Pythonic day!`

    `~`

    `:wq`ⅱ

5.  和前面的例子一样，在对文件进行修改后，您通常希望在退出 vi 时保存修改后的文件。另一种退出 vi 的方法是在命令模式下键入`:x`。

    目标:学习在 vi 中保存和退出文件的另一种方法。

    `Python lives in the jungle.`

    `Also, python lives on my computer.`

    `Have a Pythonic day!`

    `~`

    `:x`ⅱ

6.  一旦退出 vi 并回到 Linux 终端控制台，发出`ls` ( `list`)然后发出`cat myfile01.txt`来验证更改。

    目标:学习在 vi 中列出当前目录下的(`ls`)文件，查看文件内容。

    `[pynetauto@localhost ex_vi]$ ls`

    `myfile01.txt`

    `[pynetauto@localhost ex_vi]$ cat myfile01.txt`

    `Python lives in the jungle.`

    `Also, python lives on my computer` `.`

    `Have a Pythonic day!`

7.  现在，这里将向您介绍一些新的 Linux 命令来执行以下任务。您将学习如何作为一个`sudo`用户登录，检查当前的工作目录，找到您的文本文件，将文件复制到根目录，然后返回到普通用户模式。你已经看到了本章接下来的内容。

    目标:学习以 root 用户身份登录，检查文件是否存在，搜索文件，并将文件复制到 root 用户文件夹中。

    `[pynetauto@localhost ex_vi]$ pwd`

    `/home/pynetauto/ex_vi`

    `[pynetauto@localhost ex_vi]$ su -`

    `Password: **********`

    `[root@localhost ~]# pwd`

    `/root`

    `[root@localhost ~]# ls myfile*`

    `ls: cannot access 'myfile*': No such file or directory`

    `[root@localhost ~]# find / -name myfile*`

    `/home/pynetauto/ex_vi/myfile01.txt`

    `[root@localhost ~]# cp /home/pynetauto/ex_vi/myfile01.txt ~/`

    `[root@localhost ~]# ls myfile*`

    `myfile01.txt`

    `[root@localhost ~]# find / -name myfile*`

    `/root/myfile01.txt`

    `/home/pynetauto/ex_vi/myfile01.txt`

#### 在 vi 中重新打开文件

在这里，您将练习在 vi 中重新打开和关闭文件。

1.  如果您继续上一个练习，您应该仍然处于 root 用户模式。现在让我们使用`su - username`回到用户模式。检查当前工作目录，然后移动到原来的`ex_vi`目录。

    用您自己的用户名替换用户名。现在你应该回到用户的主目录和`ex_vi`目录。

    目标:学习作为标准用户重新登录。

    `[root@localhost ~]# su - pynetauto`

    `[pynetauto@localhost ~]$ pwd`

    `/home/pynetauto`

    `[pynetauto@localhost ~]$ ls`

    `Desktop  Downloads Music   Public   Videos`

    `Documents ex_vi   Pictures Templates`

    `[pynetauto@localhost ~]$ cd ex_vi`

    `[pynetauto@localhost ex_vi]$ pwd`

    `/home/pynetauto/ex_vi`

2.  要重新打开一个现有的文件，只需键入`vi`，后跟文件名。如果你不小心打开了一个文件，不想做任何修改，只需输入`:q`并按回车键。

    目标:学习从 vi 中重新打开现有文件并退出(退出)而不修改文件。

    `[pynetauto@localhost ex_vi]$ ls`

    `myfile01.txt`

    `[pynetauto@localhost ex_vi]$ vi myfile01.txt`

    `Python lives in the jungle.`

    `Also, python lives on my computer.`

    `Have a Pythonic day!`

    `~`

    `:q ↲`

3.  如果您打开文件，进入插入模式，并开始编辑文件，但决定不保存更改就退出，您可以使用`:q!`。在这个例子中，`“Goodbye.”`被添加到第四行，但是我们想放弃它并退出而不保存更改。

    目标:修改文件后学会退出。

    `Python lives in the jungle.`

    `Also, python lives on my computer.`

    `Have a Pythonic day!`

    `Goodbye` `.`

    `~`

    `:q! ↲`

    如果你修改了文件，只使用了`:q`并按下回车键，vi 会要求你在`:q`后添加`!`。

    `Python lives in the jungle.`

    `Also, python lives on my computer.`

    `Have a Pythonic day!`

    `Goodbye.`

    `~`

    `E37: No write since last change (add ! to override)                                     4,8     All`

4.  要查看文件的内容而不在 vi 中打开它，您可以使用`cat`、`more`和`less`命令。尝试所有三个命令，但是当您使用`less`命令时，您可以使用 Ctrl+Z 键退出。

    目标:学习使用`cat`、`more`和`less`命令查看文件内容。

    `[pynetauto@localhost ex_vi]$ cat myfile01.txt`

    `Python lives in the jungle.`

    `Also, python lives on my computer.`

    `Have a Pythonic day!`

    `[pynetauto@localhost ex_vi]$ more myfile01.txt`

    `Python lives in the jungle.`

    `Also, python lives on my computer` `.`

    `Have a Pythonic day!`

    `[pynetauto@localhost ex_vi]$ less myfile01.txt`

    `[2]+ Stopped         less myfile01.txt`

#### 在 vi 中复制和粘贴一行

您可以使用`dd`在 vi 中复制一行，并使用 P 键在光标位置下方粘贴一行。或者使用 P 键在光标位置上方粘贴一条线。你可以很容易地记住这个操作。尝试使用 P 键粘贴到光标位置下方，使用 P 键粘贴到光标位置上方。

1.  再次打开 vi 中的`myfile01.txt`。将光标移动到第三行，因为您要剪切第三行。

    目的:在 vi 命令模式下移动光标。

    `Python lives in the jungle.`

    `Also, python lives on my computer.`

    `|Have a Pythonic day!                       # cursor line`

    `~`

    `"myfile01.txt" 3L, 84C                    3,1      All`

2.  连续按两次 D 键。该操作将剪切光标所在的行。

    目标:使用`dd.`切断活动线上的字符串

    `dd`

    `Python lives in the jungle.`

    `|Also, python lives on my computer.` `# cursor line`

    `~`

    `~`

    `"myfile01.txt" 3L, 84C                    3,1      All`

3.  现在按 P 键粘贴“有一个 Pythonic 式的一天！”之前“还有，python 在我的电脑上。”您已经成功交换了第二行和第三行。

    目标:将复制的行粘贴到光标位置上方的行。

    `P`

    `Python lives in the jungle.`

    `|Have a Pythonic day!                       # cursor line`

    `Also, python lives on my computer.`

    `~`

    `"myfile01.txt" 3L, 84C                    2,1      All`

4.  现在你想在第四行加上同样的句子。将光标移动到第三行位置。

    目标:向下移动光标。

    `Python lives in the jungle.`

    `Have a Pythonic day!` `# cursor line`

    `|Also, python lives on my computer.`

    `~`

    `"myfile01.txt" 3L, 84C                    3,1      All`

5.  这次按 P 键粘贴“这是我的文件 01。”第一行以上。

    目标:将复制的行粘贴到光标位置下方的行。

    `p`

    `Python lives in the jungle.`

    `Have a Pythonic day!`

    `Also, python lives on my computer.`

    `|Have a Pythonic day!` `# cursor line`

    `~`

    `4,1      All`

6.  现在按一次 Esc 键，然后使用`:wq`保存更改并退出 vi。

    目标:保存更改并退出 vi。

    `:wq ↲`

    `Python lives in the jungle.`

    `Have a Pythonic day!`

    `Also, python lives on my computer.`

    `Have a Pythonic day!`

    `~`

    `:wq ↲`

#### 撤消 vi 中的最后一个

如果出错，您可以在命令模式下使用`:u`撤销上一次操作。

1.  `:u`(撤销)是基本命令之一，因为它允许你撤销你的最后一个操作。在 vi 中，这就像一个开关，撤销和重做你最近的动作。首先，在`–INSERT--`模式下，重新打开`myfile01.txt`，在第 5 行输入一些内容，如下所示。

    目标:学习撤销 vi 中的最后一个动作。

    `Python lives in the jungle.`

    `Have a Pythonic day!`

    `Also, python lives on my computer.`

    `Have a Pythonic day!`

    `You can do it!|` `# cursor line`

    `~`

    `-- INSERT --                        All`

    按 Esc 键退出插入模式并返回命令模式。键入`:u`并按下键盘上的 Enter 键来撤销您的上一个操作。

    `Python lives in the jungle.`

    `Have a Pythonic day!`

    `Also, python lives on my computer` `.`

    `Have a Pythonic day!`

    `You can do it!`

    `~`

    ：u ↲

    一旦你按下回车键，你刚刚添加的第五行将被删除(撤消)。

    `Python lives in the jungle.`

    `Have a Pythonic day!`

    `Also, python lives on my computer.`

    `Have a Pythonic day!`

    `~`

    `1 line less; before #1 23:18:48        4,20     All`

有些人非常喜欢 vi 编辑器，他们会在 Windows 上安装一个名为 gvim 的 Windows 版本的 vi，并将其用作他们首选的 Windows 文本编辑器。对于大多数新用户来说，你可能需要一段时间来适应 vi。

URL: [` www。我来了. org/ download. php`](https://www.vim.org/download.php)

#### 在 vi 中搜索文本

vi 编辑器还提供了字符串搜索。您可以在命令模式下使用`/string`来搜索您正在寻找的字符串。Cisco IOS `show`命令也提供此功能。例如，在您的 Cisco 路由器上运行`show run`命令时，您可以使用`/line vty`跳到线路的末端。

1.  再次，在 vi 中打开`myfile01.txt`文件。您可以使用字符串来搜索文本。将光标放在文件的开头，并在命令模式下键入`/Python`。搜索词将会突出显示。记住 Python 中的 P 是大写字母，所以这个搜索区分大小写。请注意，第三行的单词`python`没有突出显示。

    目标:学习在 vi 中搜索字符串和浏览文本文件。

    `Python lives in the jungle.`

    `Have a Pythonic day!`

    `Also, python lives on my computer.`

    `Have a Pythonic day!`

    `~`

    `/Python` `# cursor line`

    按一次回车键，移动到第一个出现的字符串`Python`。光标移动到搜索单词的第一个字母。

    再输入一次`/Python`,然后按回车键找到下一个出现的字符串。

    `Python lives in the jungle.`

    `Have a Pythonic day!`

    `Also, python lives on my computer.`

    `Have a Pythonic day!`

    `~`

    `/Python ↲`

    按回车键，然后按一次 N 键，移动到最后出现的字符串`Python.`

    `Python lives in the jungle.`

    `Have a Pythonic day!`

    `Also, python lives on my computer.`

    `Have a |Pythonic day!` `# cursor line`

    `~`

    `/Python              4,8     All`

    按 Shift+N 向后移动。注意左下角的`/`符号变成了`?`。

    `Python lives in the jungle.`

    `Have a |Pythonic day!` `# cursor line`

    `Also, python lives on my computer` `.`

    `Have a Pythonic day!`

    `~`

    `?Python              2,8     All`

![img/492721_1_En_7_Figf_HTML.gif](img/492721_1_En_7_Figf_HTML.gif)如果想把 vim 做成 IDE，可以参考下面这篇文章做参考。

URL: [`https://realpython.com/vim-and-python-a-match-made-in-heaven/`](https://realpython.com/vim-and-python-a-match-made-in-heaven/)

#### 在 vi 中显示行号

在 vi 文本编辑器中工作时，一些文本行或代码是可以管理的，但是随着文本/代码行的增加，您很容易迷失在文本/代码行中。为了跟踪当前的工作位置，vi 有一个编号功能。您可以通过在命令模式下键入`:set number`来打开行编号。

1.  在 vi 中重新打开`myfile01.txt`，输入`:set number`，按回车键。

    目标:启用和禁用行号。

    `1 Python lives in the jungle.`

    `2 Have a Pythonic day!`

    `3 Also, python lives on my computer.`

    `4 Have a Pythonic day!`

    `~`

    `:set number ↲`

    `4,1     All`

    **注意**如果你想关闭编号，在命令模式下键入`:set nonumber`。

    `Python lives in the jungle` `.`

    `Have a Pythonic day!`

    `Also, python lives on my computer.`

    `Have a Pythonic day!`

    `~`

    `:set nononumber ↲`

    `4,1     All`

vi 中有更多的命令，但是您已经完成的练习包含了开始使用 Linux 操作系统所需要的基本知识。接下来，您将了解 nano 文本编辑器。对于大多数 Windows PC 用户来说，在 Linux 操作系统环境下处理文件时，nano 可能是一个更好的文本编辑器。

![img/492721_1_En_7_Figg_HTML.gif](img/492721_1_En_7_Figg_HTML.gif)如果您想了解更多关于 vi 的信息，请访问以下网址了解更多详情:

URL: [`https://www.tecmint.com/vi-editor-usage/`](https://www.tecmint.com/vi-editor-usage/)

URL: [`https://www.washington.edu/computing/unix/vi.html`](https://www.washington.edu/computing/unix/vi.html)

### 纳米简介

与 vi 不同，nano 在 Linux 上几乎没有学习曲线；这是一个易于使用的文本编辑器，具有通用和简单的用户界面。默认情况下，nano text editor 安装在大多数较新的 Linux 发行版上，但可能不会安装在较旧的发行版上。它还可以与`sudo`命令配合使用。在最新的 CentOS 8.1 上，应预装 nano 2.9.8 或更新版本，并可立即使用。如果您使用 Ubuntu Server 20 进行 Linux 练习，您应该已经预装了 nano 4.8 或更高版本。如果没有预装，那么只需要一个简单的`yum`命令就可以在您的 Linux 机器上安装这个程序。在安装 nano 文本编辑器之前，我们先来看看 nano 中使用的一些键盘命令。这些命令可从 nano 界面获得，因此您不必记住它们。查看表 7-4 中的可用命令，并在进入下一节之前至少阅读一次描述。

表 7-4。

nano 文本编辑器主键

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"></colgroup> 
| 

命令

 | 

描述

 |
| --- | --- |
| `nano[filename]` | 打开编辑器命令。 |
| Ctrl+X | 退出编辑模式组合键。 |
| Y | 按 Ctrl+X 并选择 Y 保存文件。 |
| 普通 | 按 Ctrl+X 并选择 N 忽略编辑。 |
| 取消 | 按 Ctrl+X 并选择取消返回到 nano 编辑器。 |
| Ctrl+K | 复制(剪切)。 |
| Ctrl+U | 浆糊。 |

#### 安装 nano

让我们快速看看如何检查您的 Linux 操作系统是否已经预装了 nano。在下面的例子中，用户名`pynetauto`用于登录 Linux。如果您在 Linux 安装部分使用了另一个用户名，您的用户名将会不同。

1.  从您的 Linux 终端控制台，运行`nano –V`或`nano --version` `.`以下示例显示了 CentOS 8 上`nano –V`命令的输出。

    目的:了解如何在 Linux 上检查 nano 版本或 nano 的可用性。

    `nano –V or nano --version`

    `# On CentOS 8.1 server`

    `[pynetauto@localhost ~]$ nano -V`

    `GNU nano, version 2.9.8`

    `(C) 1999-2011, 2013-2018 Free Software Foundation, Inc.`

    `(C) 2014-2018 the contributors to nano`

    `Email: nano@nano-editor.org  Web:` `https://nano-editor.org/`

    `Compiled options: --enable-utf8`

    `# On Ubuntu 20.04 LTS server`

    `pynetauto@ubuntu20s1:~$ nano --version`

    `GNU nano, version 4.8`

    `(C) 1999-2011, 2013-2020 Free Software Foundation, Inc.`

    `(C) 2014-2020 the contributors to nano`

    `Email: nano@nano-editor.org  Web:` `https://nano-editor.org/`

    `Compiled options: --disable-libmagic --enable-utf8`

2.  检查 Linux 系统上是否安装了 nano 的另一种方法是使用`nano [filename]`命令创建并打开一个新文件。如果您的 Linux 系统上没有安装 nano text editor，Linux 将返回一个`“No such file or directory” –bash`错误。此外，当我们之前研究 Linux 目录结构时，我们看到可执行程序文件通常驻留在`/usr/bin/;`中，快速检查该目录下是否存在 nano 以再次确认。

    目标:通过查看`/usr/bin`目录，检查您的 Linux 系统上是否有 nano。

    `[pynetauto@localhost ~]$ nano -V`

    `bash: nano: command not found...`

    `Install package 'nano' to provide command 'nano'? [N/y] N`

    `[pynetauto@localhost ~]$ nano myfile02.txt`

    `bash: nano: command not found...`

    `Install package 'nano' to provide command 'nano'? [N/y] N`

    `[pynetauto@localhost ~]$ ls /usr/bin/nano`

    `ls: cannot access '/usr/bin/nano': No such file or directory`

3.  如果您遇到了与前面类似的错误，那么是时候在您的 Linux 操作系统上安装 nano 了。如果你像下面的例子一样以标准用户的身份登录，运行`sudo yum install –y nano`命令并输入`sudo`密码，你可以用一行带有`–y`句柄的代码来安装 nano。如果你作为根用户登录，你可以在`yum`命令前放下`sudo`。将`install`一词替换为`remove`卸载 nano。

    目标:在您的 Linux 服务器上安装和卸载 nano。

    `# To install nano on CentOS/Red Hat/Fedora Linux`

    `[pynetauto@localhost ~]$ sudo yum install nano`

    `[sudo] password for pynetauto: **********`

    `# To uninstall nano`

    `[pynetauto@localhost ~]$ sudo yum remove -y nano`

    `# To install nano on Ubuntu/Debian/Mint Linux`

    `pynetauto@ubuntu20s1:~$ sudo apt-get install -y nano`

    `[sudo] password for pynetauto: **********`

    `# To uninstall nano`

    `pynetauto@ubuntu20s1:~$ sudo apt-get remove -y nano`

    如果你使用的是 Ubuntu Server 20 并且缺少 nano 编辑器，使用`apt-get install nano`命令安装 nano。CentOS 和 Ubuntu 之间细微的语法差异通常来自于不同安装程序的使用。在 CentOS、Red Hat 和 Fedora 等基于 Red Hat 的发行版上，您必须运行`yum`(*yellow dog Updater Modified*)命令。正在慢慢取代`yum`的新成员是`dnf`，它正在使用 RPM 包管理器。基于 Debian 的发行版如 Ubuntu、Debian 和 Mint Linux 使用`apt`(高级打包工具)作为安装程序。

4.  现在快速运行`ls /usr/bin/nano`命令来确认安装成功。

    目标:检查 nano 安装是否成功。

    `# On CentOS 8.1 server`

    `[pynetauto@localhost ~]$ ls /usr/bin/nano`

    `/usr/bin/nano`

    `# On Ubuntu 20.04 LTS server`

    `pynetauto@ubuntu20s1:~$ ls /usr/bin/nano`

    `/usr/bin/nano`

#### 用 nano 创建/打开文件

您已经确认 nano 已成功安装，并准备好使用新应用编辑文件。如前所述，您可以使用您的 Ubuntu 或 CentOS 虚拟服务器进行此练习。

让我们以标准用户的身份重新登录，并创建一个新目录来开始 nano 练习。

1.  首先，通过键入`mkdir ex_nano.`创建一个名为`ex_nano`的新目录，您将使用该目录来存储在练习过程中创建的练习文件。通过键入`cd ex_nano`将工作目录更改为`ex_nano`。

    目标:创建一个新的目录来练习使用 nano 文本编辑器。

    `[pynetauto@localhost ~]$ mkdir ex_nano`

    `[pynetauto@localhost ~]$ cd ex_nano`

    `[pynetauto@localhost ex_nano]$ ls`

    `[pynetauto@localhost ex_nano]$ pwd`

    `/home/pynetauto/ex_nano`

2.  如果执行如下所示的命令`nano myfile02.txt`，如果同名文件不存在，将打开一个新文件。如果存在同名文件，它将重新打开现有文件。

    Nano 有一个伪图形化的用户界面，只要你打开一个文件，帮助菜单就会显示在底部，让你感觉像在家里一样；你想直接投入使用它。如果你习惯了 Windows 上的记事本，使用这个用户友好的工具将不会有问题。

    目标:使用`nano`命令创建一个新文件。

    `nano filename ↲`

    `[pynetauto@localhost ex_nano]$ nano myfile02.txt`

    `GNU nano 2.9.8           myfile02.txt`

    `|`

    `^G Get Help ^O Write Out  ^W Where Is ^K Cut Text  ^J Justify   ^C Cur Pos`

    `^X Exit   ^R Read File  ^\ Replace  ^U Uncut Text ^T To Spell  ^_ Go To Line`

3.  在打开一个新文件并立即决定退出 nano 而不编辑该文件后，该文件将被丢弃。要退出 nano，请使用`^X`(Ctrl+X 键)。如果你想先创建一个新文件，使用`touch myfile02.txt`然后用 nano `myfile02.txt`命令打开它。在 nano 中，如果你看到`^`符号，那意味着 Ctrl 键。

    目标:使用`touch`命令创建一个新文件。

    `[pynetauto@localhost ex_nano]$ nano myfile02.txt`

    `[pynetauto@localhost ex_nano]$ ls`

    `[pynetauto@localhost ex_nano]$ touch myfile02.txt`

    `[pynetauto@localhost ex_nano]$ ls`

    `myfile02.txt`

4.  现在重新运行`nano myfile02.txt`命令并输入几行文本。正如您已经发现的，nano 编辑器不要求您像在 vi 编辑器中那样按 I 键进入`-- INSERT --`模式。完成后，要退出 nano，必须按 Ctrl+X ( `^X`)。

    目标:写入新文件并退出。

    `GNU nano 2.9.8           myfile02.txt           Modified`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle management`

    `Save modified buffer? (Answering "No" will DISCARD changes.)`

    `Y Yes`

    `N No      ^C Cancel`

5.  要保存文件，请按 Y(是)，然后按 Enter 键。或者忽略更改，请按 N(否)。若要返回文件进行进一步编辑，请按^C (Ctrl+C)。在 Linux 操作系统上，大部分程序都是区分大小写的，但 nano 菜单是个例外；它不区分大小写，所以可以互换使用 Y 表示 Y，N 表示 N。

    目标:保存已更改的文件。

    `Y ↲`

    `GNU nano 2.9.8           myfile02.txt           Modified`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle management`

    `File Name to Write: myfile02.txt`

    `^G Get Help     M-D DOS Format   M-A Append     M-B Backup File`

    `^C Cancel      M-M Mac Format   M-P Prepend     ^T To Files`

6.  使用`more`、`less`或`cat`命令，后跟保存的文件名，`myfile02.txt.`如果您使用了`less myfile02.txt`命令，您可以使用 Q 键退出`less.`

    目的:使用`cat`、`more`或`less`查看文件内容。

    `[pynetauto@localhost ex_nano]$ ls -l`

    `total 4`

    `-rw-rw-r--. 1 pynetauto pynetauto 127 Jan 3 01:27 myfile02.txt`

    `[pynetauto@localhost ex_nano]$ more myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle management`

您刚刚学习了如何在 nano 中创建/打开、保存和关闭文件。Linux 中有许多优秀的文本编辑器，比如 emacs、gedit、leafpad 和 Komodo，但是这些文本编辑器不会在本章或本书中讨论。当你有空闲时间的时候，你应该从谷歌搜索中探索其他基于 Linux 的文本编辑工具。

#### 用 nano 重新打开文件

1.  要在 nano 中重新打开一个现有的文本文件，您可以使用`nano [filename]`，就像上一个练习中一样。因此，键入`nano myfile02.txt`打开一个现有的文件。

    目标:重新打开一个现有文件。

    `[pynetauto@localhost ex_nano]$ nano myfile02.txt`

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle management`

    `[ Read 5 lines ]`

    `^G Get Help ^O Write Out  ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File  ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

#### 用 nano 剪切(删除)和粘贴

1.  在 nano 中工作时，要剪切一行，首先移动到要剪切(或复制)的行，然后使用 Ctrl+K 组合键粘贴(取消剪切)使用 Ctrl+U 组合键。如果不粘贴剪切的信息，计算机内存中的信息将被丢弃，其作用类似于删除。

    重新打开`myfile02.txt`并将光标放在第 4 行。

    目的:在 nano 中剪切(删除)一行。

    `[pynetauto@localhost ex_nano]$ nano myfile02.txt`

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle management`

    `[ Read 5 lines ]`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text   ^J Justify   ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text  ^T To Spell   ^_ Go To Line`

    要删除第 4 行，请按 Ctrl+K。第 4 行对我们来说似乎已经被删除了，但 nano 会将第 4 行剪切并放入您的服务器内存中。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year` `.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `|4\. Life-cycle management` `# cursor line`

    `[ Read 5 lines ]`

    `^G Get Help ^O Write Out  ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File  ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

2.  如果要复制和粘贴特定的字符串，首先将光标移动到要开始复制的第一个位置。在这个例子中，我们想要从第 4 行中删除单词`Life-cycle`。

    目标:学习如何复制和粘贴一个特定的字符串。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `4\. |Life-cycle management` `# cursor line`

    `[ Read 5 lines ]`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

    然后按 Ctrl+6 并使用右箭头[→]突出显示单词或字符串。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `4\. Life-cycle| management` `# cursor line`

    `[ Read 5 lines ]`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

    然后按 Ctrl+K 剪切字符串。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `4\. | management` `# cursor line`

    `[ Read 5 lines ]`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

3.  现在使用箭头键将光标移动到第 3 行，并剪切第 3 行。我们想把 3 号线移到 2 号线。按 Ctrl+K 复制该行。

    目的:使用 nano 中的剪切粘贴功能。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `|2\. Network monitoring` `# cursor line`

    `4\. management`

    `[ Read 5 lines ]`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replac  ^U Uncut Text ^T To Spell ^_ Go To Line`

    现在将光标移动到第 2 行。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `|1\. IOS upgrade` `# cursor line`

    `4\. management`

    `[ Read 5 lines ]`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

    按 Ctrl+U 粘贴(插入)复制的行。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `2\. Network monitoring`

    `|1\. IOS upgrade` `# cursor line`

    `4\. management`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

4.  如果要剪切多行，请将光标放在第一个位置，并多次按 Ctrl+K 键。复制的多行将被存储在计算机存储器中。我已经把光标放在第 2 行的开头，然后连续按 Ctrl + K ↲三次。

    目的:在 nano 中剪切和粘贴多行。

    `Position the cursor in the first line to cut.`

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `|2\. Network monitoring`

    `1\. IOS upgrade` `# cursor line`

    `4\. management`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

    多次使用 Ctrl+K 来剪切三行。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `|`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

    现在光标应该定位在第二行；按 Ctrl+U 键两次，粘贴复制两次的三行。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `2\. Network monitoring`

    `1\. IOS upgrade`

    `4\. management`

    `2\. Network monitoring`

    `1\. IOS upgrade`

    `4\. management`

    `|` `# cursor line`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

    使用 Ctrl+X 并按 N 放弃更改并退出 nano。当您再次打开文件时，文件的内容应该保持在原始文件中。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle management`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justif  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

#### 字符串搜索和替换字符串

1.  在 nano 中，您可以使用 Ctrl+W 来搜索字符串，并且搜索不区分大小写。在下面的例子中，您将搜索单词 *backup* 。

    目标:在 nano 中搜索特定的单词或字符串。

    按 Ctrl+W，然后键入单词`backup` ↲

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle management`

    `Search: backup|` `# cursor line`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

    只要你按下回车键，光标就会移动到单词 *backup* 。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration |backup` `# cursor line`

    `4\. Life-cycle management`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justif  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

2.  要搜索一个字符串并替换匹配的字符串，可以使用`^\` (Ctrl+\)。

    目的:在 nano 中搜索和替换单词。

    `Ctrl+\`

    首先，让我们追加第五项，“5。设备数据库管理"，在我们的列表中如下:

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle management`

    `5\. Device database management|` `# cursor line`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

    使用 Ctrl+\搜索一个字符串，在本例中是一个单词: *management* 。我们想把这个词换成*行政*。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle management`

    `5\. Device database management`

    `Search (to replace): management|                    # cursor line`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

    输入替换单词 *administration* ，然后按键盘上的 Enter 键。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle management`

    `5\. Device database management`

    `Replace with: administration`

    `^G Get Help        ^Y First Line       ^P PrevHstory`

    `^C Cancel         ^V Last Line       ^N NextHstory`

    nano 会突出显示搜索词*管理*的第一个实例。我们想用*管理*替换所有匹配，所以选择 a

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle management`

    `5\. Device database management`

    `Replace this instance?`

    `Y Yes      A All`

    `N No      ^C Cancel`

    所有实例都将被替换，如下所示:

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle administration`

    `5\. Device database administration`

    `[ Replaced 2 occurrences ]`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

3.  您可以使用^O (Ctrl+O)然后使用 Enter 键保存更改，而无需关闭 nano 编辑器。该命令的作用类似于“保存”按钮。

    目标:使用 Ctrl+O 选项保存文件。

    `Ctrl+O`ⅱ

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle administration`

    `5\. Device database administration`

    `File Name to Write: myfile02.txt`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

#### 为 Python 编码定制 nano

当使用 nano 在 Python 中编码时，您会注意到一些缺失的特性，例如避免按空格键四次的四空格制表符和快速告知当前工作位置的行号选项。要定制这些设置，您必须更改`/etc/nanorc`文件中的几个设置。

1.  要在 nano 中将制表符从八个空格改为四个空格，请执行以下步骤:

    使用`sudo nano /etc/nanorc`打开一个`nanorc`文件。如果提示输入密码，请输入`sudoer`密码。

    目的:在 nano 中为 Python 编码启用四空格跳转。

    使用带有键`set tabsize`的`^W` (Ctrl+W)命令搜索 nanorc 文件。

    `GNU nano 2.9.8           /etc/nanorc`

    `## Allow nano to be suspended.`

    `# set suspend`

    `## Use this tab size instead of the default; it must be greater than 0.`

    `# |set tabsize 8`

    `## Convert typed tabs to spaces.`

    `# set tabstospaces`

    `Search: set tabsize`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text  ^J Justify  ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text ^T To Spell ^_ Go To Line`

    删除#(哈希)以激活此配置设置；把 8 改成 4。然后添加下一行`set tabstospaces`，如下所示。确保保存更新的`nanorc`配置文件。

    `GNU nano 2.9.8           /etc/nanorc`

    `## Allow nano to be suspended.`

    `# set suspend`

    `## Use this tab size instead of the default; it must be greater than 0.`

    `set tabsize 4`

    `set tabstospaces|`

    `## Convert typed tabs to spaces.`

    `# set tabstospaces`

    `[ line 172/279 (61%), col 3/16 (18%), char 5826/9448 (61%) ]`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text   ^J Justify   ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text  ^T To Spell   ^_ Go To Line`

    现在是时候检查更改了，重新打开`myfile02.txt`，并使用 Tab 键在第 3–6 行添加四个空格进行确认。每次使用 Tab 键时，您都为正在运行的 Python 代码添加了四个空格。第二行增加了四个空格，第三行增加了八个空格，第四行增加了十二个空格。

    `GNU nano 2.9.8           myfile02.txt`

    `List of tasks to be automated this year.`

    `1\. IOS upgrade`

    `2\. Network monitoring`

    `3\. Configuration backup`

    `4\. Life-cycle administration`

    `|5\. Device database administration`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text   ^J Justify   ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text  ^T To Spell   ^_ Go To Line`

    如果想撤销之前的更改，可以打开`/etc/nanorc`文件，将`#`添加到两行并保存。

2.  使用`sudo nano /etc/nanorc`再次打开 nanorc 文件。搜索`set linenumbers`并删除该行开头的`#`符号，保存更改。

    目的:在 nano 中启用行号。

    `[pynetauto@localhost ex_nano]$ sudo nano /etc/nanorc`

    `[sudo] password for pynetauto: **********`

    拆下`set linenumbers`前面的`#`；这将启用 nano 中的行编号。

    `GNU nano 2.9.8           /etc/nanorc           Modified`

    `## Remember the used search/replace strings for the next session.`

    `# set historylog`

    `## Display line numbers to the left of the text` `.`

    `set linenumbers`

    `## Enable vim-style lock-files. This is just to let a vim user know you`

    `## are editing a file [s]he is trying to edit and vice versa. There are`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text   ^J Justify   ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text  ^T To Spell   ^_ Go To Line`

    在 nano 中打开`myfile02.txt`，检查行号是否可见。

    `GNU nano 2.9.8           myfile02.txt`

    `1 List of tasks to be automated this year.`

    `2 1\. IOS upgrade`

    `3   2\. Network monitoring`

    `4     3\. Configuration backup`

    `5       4\. Life-cycle administration`

    `6         5\. Device database administration`

    `7`

    `[ Read 6 lines ]`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text   ^J Justify   ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text  ^T To Spell   ^_ Go To Line`

    如果您想撤销更改，您可以打开`/etc/nanorc`文件并将`#`添加回同一行并保存。

起初，vi 和 nano 文本编辑器对 Windows 用户来说很难使用，但这是因为你不熟悉这些程序。随着你花更多的时间使用这些应用，你会变得更加舒适。所以，慢慢来，但千万不要放弃这些应用。如果您知道如何正确使用 vi 文本编辑器，那么您已经掌握了 Linux 管理的重要部分。这是我爸的笑话，但是说的太对了:“学习 Linux 管理的前半部分就是学习如何使用 vi。”当然，nano 文本编辑器支持更多的功能。如果你想了解更多关于其他命令的信息，请参考这个链接: [`https://www.cheatography.com/pepe/cheat-sheets/nano/`](https://www.cheatography.com/pepe/cheat-sheets/nano/) 。

许多读者可能不喜欢 Linux 章节，因为这涉及到用户远离 GUI，在终端控制台上呆上几个小时，但是这是一个非常重要的过程，需要在 Linux 中适应，以后在 Linux 上用 Python 编写代码时也是如此。

## Linux 基本管理

既然您已经熟悉了 vi 和 nano 文本编辑器，那么让我们学习一些基本的 Linux 管理来帮助您入门。

### 更改主机名

在第 5 和 6 章节中，你安装了带有桌面选项的 Ubuntu 20 和 CentOS 8.1 服务器，但是 CentOS 8.1 服务器上的服务器名称(`hostname`)被保留为`localhost`。相比之下，在 Ubuntu Server 20 上，服务器名称(`hostname`)是在安装操作系统期间配置的。在本节中，让我们将 CentOS 服务器的主机名更改为`centos8s1`，这赋予了服务器更多的含义。虽然桌面可用，但我们将通过终端控制台更新主机名。以下主机名更改过程适用于 Red Hat (CentOS)和 Debian (Ubuntu) Linux 服务器:

1.  首先，让我们学习如何检查主机名。有几种方法可以检查当前分配给服务器的主机名，这里是一些 Linux 命令。如果您检查的不仅仅是主机名本身，那么`hostnamectl`命令会提供最有用的信息。此外，包含该名称的文件位于`/etc/hostname`文件下。所有这些命令都是 Linux 命令，所以它们区分大小写。

    目标:学习如何在 Linux 上使用命令行更改主机名。

    `[pynetauto@localhost ~]$ hostname`

    `localhost`

    `[pynetauto@localhost ~]$ echo "$HOSTNAME"`

    `localhost`

    `[pynetauto@localhost ~]$ printf "%s\n" $HOSTNAME`

    `localhost`

    `[pynetauto@localhost ~]$ hostnamectl`

    `Static hostname: localhost`

    `Icon name: computer-vm`

    `Chassis: vm`

    `Machine ID: e53c131bb54c4fb1a835f3aa435024e2`

    `Boot ID: 9acca137c1f04ca0ae0db3b6b28db63e`

    `Virtualization: vmware`

    `Operating System: CentOS Linux 8 (Core)`

    `CPE OS Name: cpe:/o:centos:centos:8`

    `Kernel: Linux 4.18.0-193.14.2.el8_2.x86_64`

    `Architecture: x86-64`

    `[pynetauto@localhost ~]$ cat /etc/hostname`

    `localhost`

2.  使用`sudo hostnamectl set-hostname [new_name]`更新服务器主机名。

    目标:

    `[pynetauto@localhost ~]$ sudo hostnamectl set-hostname centos8s1`

    `[sudo] password for pynetauto:`

    `[pynetauto@localhost ~]$`

    如果您使用诸如 nano 之类的文本编辑器，您可以打开`/etc/hosts`文件，并使用 Ctrl+\方法将当前主机名(`localhost`)更新为新的服务器名称。在本例中，新的主机名是`centos8s1`。

    `GNU nano 2.9.8           /etc/hosts`

    `1 127.0.0.1  localhost localhost.localdomain localhost4 localhost4.localdomain4`

    `2 ::1     localhost localhost.localdomain localhost6 localhost6.localdomain6`

    `[ Read 2 lines ]`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text   ^J Justify   ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text  ^T To Spell   ^_ Go To Line`

    使用 nano 的 Ctrl+\将所有`localhost`实例更改为`centos8s1`。

    `GNU nano 2.9.8           /etc/hosts`

    `1 127.0.0.1  localhost localhost.localdomain localhost4 localhost4.localdomain4`

    `2 ::1     localhost localhost.localdomain localhost6 localhost6.localdomain6`

    `Search (to replace) : localhost`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text   ^J Justify   ^C Cur Pos`

    `^X Exit   ^R Read File ^\ Replace  ^U Uncut Text  ^T To Spell   ^_ Go To Line`

    `GNU nano 2.9.8           /etc/hosts`

    `1 127.0.0.1  localhost localhost.localdomain localhost4 localhost4.localdomain4`

    `2 ::1     localhost localhost.localdomain localhost6 localhost6.localdomain6`

    `Replace with: centos8s1`

    `^G Get Help        ^Y First Line       ^P PrevHstory`

    `^C Cancel         ^V Last Line       ^N NextHstory`

    `GNU nano 2.9.8           /etc/hosts`

    `1 127.0.0.1  localhost localhost.localdomain localhost4 localhost4.localdomain4`

    `2 ::1     localhost localhost.localdomain localhost6 localhost6.localdomain6`

    `Replace this instance? A`

    `Y Yes      A All`

    `N No      ^C Cancel`

    修改主机文件后，它应该类似于以下内容:

    `GNU nano 2.9.8        /etc/hosts                Modified`

    `1 127.0.0.1  centos8s1 centos8s1.localdomain centos8s14 centos8s14.localdomain4`

    `2 ::1     centos8s1 centos8s1.localdomain centos8s16 centos8s16.localdomain6`

    `[ Replaced 8 occurences ]`

    `^G Get Help ^O Write Out ^W Where Is ^K Cut Text   ^J Justify   ^C Cur Pos`

    `^X Exit     ^R Read File  ^\ Replace   ^U Uncut Text^T To Spell ^_ Go To Line`

    现在使用`sudo reboot`命令重启服务器，让新的主机名生效。

    `[pynetauto@localhost ~]$ sudo reboot`

    `[sudo] password for pynetauto: **********`

    当您的 CentOS 服务器重新启动时，使用 PuTTY 通过 SSH 进入服务器，您应该会看到主机名更改为`centos8s1.`

    `login as: pynetauto`

    `pynetauto@192.168.183.130's password: **********`

    `Activate the web console with: systemctl enable --now cockpit.socket`

    `Last login: Mon Jan 4 11:23:12 2021 from 192.168.183.1`

    `[pynetauto@centos8s1 ~]$`

3.  请注意，Ubuntu 的主机名已经在安装过程中设置好了，您不必在这里执行任何其他操作。

    `pynetauto@ubuntu20s1:~$ hostname`

    `ubuntu20s1`

    `pynetauto@ubuntu20s1:~$ echo "$HOSTNAME"`

    `ubuntu20s1`

    `pynetauto@ubuntu20s1:~$ printf "%s\n" $HOSTNAME`

    `ubuntu20s1`

    `pynetauto@ubuntu20s1:~$ hostnamectl`

    `Static hostname: ubuntu20s1`

    `Icon name: computer-vm`

    `Chassis: vm`

    `Machine ID: ea202235f9834d979436db10d89b1347`

    `Boot ID: 6a4035617bf348cba128be8e9d29d6a9`

    `Virtualization: vmware`

    `Operating System: Ubuntu 20.04.1 LTS`

    `Kernel: Linux 5.4.0-47-generic`

    `Architecture: x86-64`

    `pynetauto@ubuntu20s1:~$ cat /etc/` `hostname`

    `ubuntu20s1`

### Linux 基本文件和目录命令

我们将首先学习管理 Linux 操作系统的基本文件和目录的必要命令。深入理解 Linux 命令通常需要很多时间。这本书不是为一般的 Linux 管理而写的，所以本章的目的是帮助你建立 Linux 管理的基础，这样你就可以在 Linux 系统上轻松地执行基本的任务。这里只介绍最基本的命令。在开始练习之前，请花时间查看表 7-5 中的每个命令。您不必马上记住所有的命令，但是可以试着熟悉一些命令语法。

表 7-5。

Linux 文件和目录基本命令

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"></colgroup> 
| 

命令

 | 

描述和示例

 |
| --- | --- |
| `pwd` | 当前工作目录`$pwd` |
| `ls` | 列表段:列出当前工作目录中的文件和目录`$ ls` |
| `ls [directory]` | `$ ls /home/pynetauto/Documents` |
| `ls –a` | 列出所有文件，包括隐藏的目录和文件`$ ls -a .bashrc` |
| `dir` | 目录`$dir` |
| `mkdir` | 制作目录`$ mkdir myapps` |
| `cd` | 更改目录`$ cd myapps``$ cd /usr/local` |
| `cd ..` | 将当前目录更改为父目录。`/myapps$ cd ..` |
| `cd ~` | 从任何地方移动到用户的主目录。`$ cd /usr/sbin``:/usr/sbin$ cd ~``$ pwd``/home/pynetauto` |
| `cd -` | 切换回之前工作的目录。`$ cd /usr/local``:/usr/local$ cd -``/home/pynetauto` |
| `rm OR rm –r` | 删除文件。`/myapps$ rm router_app.py` |
| `rmdir` | 删除目录`$ rmdir myapps` |
| `mv` | 重命名文件名。`$ mv file01.py myfile01.py` |
| `mv file directory` | 将文件移动到另一个目录。`$ mv file01.py ./Documents` |
| `mv directory_A directory_B` | 将一个目录重命名为另一个目录。`$ mv myapps myscripts` |
| `touch filename` | 创建文件。`$ touch myfile04.txt``$ touch myfile05.txt myfile06.txt` |
| `cp` | 将文件复制到另一个目录，或者用另一个文件名复制并粘贴。`$ cp myfile01.py /home/pynetauto/Documents` |
| `cp –a directory_A directory_B` | 将一个目录复制到另一个目录。`$ cp -a Documents Mydocs` |
| `find` | 找个文件。`$ find /home/pynetauto -name "myfile*"` |
| `grep` | 从文件中搜索字符串。`$ grep pynetauto /etc/passwd``$ grep 'Python' /home/pynetauto/myfile10.py` |

### Linux 文件和目录练习

现在让我们通过一些练习来学习 Linux 基本的文件和目录管理。

到目前为止，之前的练习都是在 CentOS 服务器上完成的。在下面的练习中，将使用 Ubuntu Server 20 LTS 服务器。这次请以 root 用户身份登录到您的 Ubuntu 虚拟机并完成练习。如果你是一个经验丰富的 Linux 管理员，你可以跳到下一章，开始在 CentOS 8.1 上安装 IP 网络应用。对于任何以粗体突出显示的命令，您必须在 Linux 控制台终端中键入它们。

```py
login as: root
root@192.168.183.132's password: **********
Welcome to Ubuntu 20.04.1 LTS (GNU/Linux 5.4.0-47-generic x86_64)

[omitted for brevity]

Last login: Sun Jun 7 08:37:49 2020 from 192.168.183.1
root@ubuntu20s1:~#

```

#### 练习 7-1

1.  使用`pwd`命令检查当前工作目录。正如您在上一节中了解到的，`pwd`代表当前工作目录。可以把它看作是您在 Linux 系统中导航的指南针。

    `root@ubuntu20s1:~# pwd`

    `/root`

2.  `ls`是一个特定于 Unix/Linux 的命令，用于查看文件和目录。稍后您将详细了解`ls`命令选项。用`mkdir`命令创建一个目录，并用`ls`列出新目录。

    `root@ubuntu20s1:~# mkdir directory1`

    `root@ubuntu20s1:~# ls`

    `Desktop   Documents Music   Pictures snap    Videos`

    `directory1 Downloads myscript Public  Templates`

3.  使用`ls directory_name`命令查看目录中的文件和子目录。继续上一个练习，使用`touch`命令在`directory1`下创建一个文件，然后使用`ls`命令查看在`directory1`下新创建的文件。

    `root@ubuntu20s1:~# touch directory1/myfile01.txt`

    `root@ubuntu20s1:~# ls directory1/`

    `myfile01.txt`

4.  `ls –d`命令指示`ls`简单地列出目录条目而不是内容。您可以使用`ls –l`命令来查看文件和目录的详细信息。`l`代表长列表。现在比较三个输出:`ls`、`ls -d`和`ls –l`。

    `root@ubuntu20s1:~# ls directory1`

    `myfile01.txt`

    `root@ubuntu20s1:~# ls -d directory1`

    `directory1`

    `root@ubuntu20s1:~# ls -l directory1`

    `total 0`

    `-rw-r--r-- 1 root root 0 Jan 4 01:39 myfile01.txt`

5.  使用`ls –a`命令一起显示隐藏的文件和文件夹。`a`代表所有，甚至显示隐藏的目录和文件。

    `root@ubuntu20s1:~# ls -a`

    `.       .cache   Documents Music   Public Templates`

    `..       .config   Downloads myscript .rpmdb Videos`

    `.bash_history Desktop   .gnupg   Pictures snap`

    `.bashrc    directory1 .local   .profile .ssh`

6.  您已经使用这个命令几次了；您可以使用`mkdir`命令创建一个新目录。目录类似于 Windows 操作系统中的文件夹；它可以包含子目录和文件。再做一个目录，得到更多的练习。

    `root@ubuntu20s1:~# mkdir directory2`

    `oot@ubuntu20s1:~# ls -d directory*`

    `directory1 directory2`

7.  `cp –a`命令允许您复制整个目录，包括原始目录中的文件和子目录。在本练习中，您将复制`directory1`来创建另一个包含相同`myfile01.txt`的目录。

    `root@ubuntu20s1:~# cp -a directory1 directory3`

    `root@ubuntu20s1:~# ls -d directory*`

    `directory1 directory2 directory3`

    `root@ubuntu20s1:~# ls directory*`

    `directory1:`

    `myfile01.txt`

    `directory2:`

    `directory3:`

    `myfile01.txt`

8.  `rmdir`将允许您删除一个空目录；该命令将删除整个目录。`directory2`是空的，所以使用`rmdir`命令删除它。

    `root@ubuntu20s1:~# ls directory2/`

    `root@ubuntu20s1:~# rmdir directory2`

    `root@ubuntu20s1:~# ls -d directory*`

    `directory1 directory3`

9.  如果要删除包含其他文件和目录的目录，可以使用`rm –rf directory_name`。应谨慎使用`rm –rf`命令，因为该选项不会提示用户确认并立即删除项目。

    `root@ubuntu20s1:~# ls directory3`

    `myfile01.txt`

    `root@ubuntu20s1:~# rm directory3`

    `rm: cannot remove 'directory3': Is a directory`

    `root@ubuntu20s1:~# rm -rf directory3`

    `root@ubuntu20s1:~# ls -d directory*`

    `directory1`

10.  `mv`命令可用于移动或重命名文件和目录。您也可以使用此命令将文件或目录移动到另一个目录；让我们通过下面的练习来了解这一点:

    `# Renaming a directory`

    `root@ubuntu20s1:~# ls -d directory*`

    `directory1`

    `root@ubuntu20s1:~# mv directory1 directory5`

    `root@ubuntu20s1:~# ls -d directory*`

    `directory5`

    `# Moving a directory to another directory`

    `root@ubuntu20s1:~# mkdir directory3`

    `root@ubuntu20s1:~# ls -d directory*`

    `directory3 directory5`

    `root@ubuntu20s1:~# mv directory3 directory5`

    `root@ubuntu20s1:~# ls -d directory*`

    `directory5`

    `root@ubuntu20s1:~# ls directory5`

    `directory3 myfile01.txt`

![img/492721_1_En_7_Figh_HTML.gif](img/492721_1_En_7_Figh_HTML.gif)Linux 中有没有更好的一目了然的目录和文件的方法？

是的，在 Linux 中有一个方便的目录工具叫做`tree`。安装`tree`后，在当前工作目录下输入`tree`命令，以树形格式显示目录和文件。使用`apt install tree`命令安装软件。

`root@ubuntu20s1:~# apt-get install tree`

`Reading package lists... Done`

`Building dependency tree`

`Reading state information... Done`

`The following NEW packages will be installed:`

`tree`

`0 upgraded, 1 newly installed, 0 to remove and 125 not upgraded.`

`[...omitted for brevity]`

`Preparing to unpack .../tree_1.8.0-1_amd64.deb ...`

`Unpacking tree (1.8.0-1) ...`

`Setting up tree (1.8.0-1) ...`

`Processing triggers for man-db (2.9.1-1) ...`

`root@ubuntu20s1:~# tree`

`.`

■t0]

■t0]

`│``directory3`

`│ └── myfile01.txt`

■t0]

■t0]

■t0]

■t0]

■t0]

■t0]

`│``docker`

`│ │``423`

`│ │``common`

`│ │ └── current -> 423`

`│ └── lxd`

`│``14804`

`│``15223`

`│``common`

`│  └── current -> 15223`

■t0]

`└── Videos`

Note

如果你不能在 Ubuntu 上安装`tree`，你可能需要启用 universe 库。在安装`tree`之前，在你的 Ubuntu 上运行以下命令:

`root@ubuntu20s1:~#``sudo add-apt-repository "deb``http://archive.ubuntu.com/ubuntu`

`root@ubuntu20s1:~#` `apt update`

`root@ubuntu20s1:~#` `apt-get install tree`

#### 练习 7-2

1.  使用`ls -d $PWD/*`命令显示工作目录的路径。

    `root@ubuntu20s1:~# ls -d $PWD/*`

    `/root/Desktop   /root/Downloads /root/Pictures /root/Templates`

    `/root/directory5 /root/Music   /root/Public  /root/Videos`

    `/root/Documents  /root/myscript  /root/snap`

2.  `cd`、`cd ..`、`cd ~`改变目录命令可以用来移动用户的工作目录位置。进行一些练习，你会在处理文件和目录时节省很多时间。让我们看一些例子，并贯彻到底。

    让我们使用`mkdir`命令创建多个目录。

    `root@ubuntu20s1:~# mkdir directory1 directory2 directory4`

    `root@ubuntu20s1:~# ls -d directory*`

    `directory1 directory2 directory4 directory5`

    `root@ubuntu20s1:~# mv directory2 directory4`

    `root@ubuntu20s1:~# ls -d directory*`

    `directory1 directory4 directory5`

    `root@ubuntu20s1:~# tree directory*`

    `directory1`

    `directory4`

    ε──t0″

    `directory5`

    ■t0]

    ε──t0″

    `2 directories, 1 file`

    键入`cd`(更改目录)并按回车键，您总是会返回到用户的主目录。移动到`root/directory4/directory2`并使用`cd`返回到 root 的工作文件夹。注意使用快捷键`./`来指定当前工作目录。`./directory4/directory2`是`/root/directory4/directory2`的简称。

    `root@ubuntu20s1:~# pwd`

    `/root`

    `root@ubuntu20s1:~# cd ./directory4/directory2`

    `root@ubuntu20s1:~/directory4/directory2# pwd`

    `/root/directory4/directory2`

    `root@ubuntu20s1:~/directory4/directory2# cd`

    `root@ubuntu20s1:~# pwd`

    `/root`

3.  `cd ..`命令将工作目录从子目录上移一级。这次让我们向下移动到`/root/directory5/directory3`并使用`cd ..`命令向上移动到父目录。请注意，您还可以使用`cd ../../`来跳多级。

    `root@ubuntu20s1:~# cd /root/directory5/directory3`

    `root@ubuntu20s1:~/directory5/directory3# pwd`

    `/root/directory5/directory3`

    `root@ubuntu20s1:~/directory5/directory3# cd ..`

    `root@ubuntu20s1:~/directory5# pwd`

    `/root/directory5`

    `root@ubuntu20s1:~/directory5# cd ..`

    `root@ubuntu20s1:~# pwd`

    `/root`

    `root@ubuntu20s1:~# cd ./directory5/directory3`

    `root@ubuntu20s1:~/directory5/directory3# pwd`

    `/root/directory5/directory3`

    `root@ubuntu20s1:~/directory5/directory3# cd ../../`

    `root@ubuntu20s1:~# pwd`

    `/root`

4.  如果您知道确切的目录路径，您可以通过键入`cd`后跟特定的目录路径，从一个工作目录跳到下一个目录。下面的练习显示了从父`directory5`下的`directory3`跳到父`directory4`下的`directory2`:

    `root@ubuntu20s1:~# cd ./directory5/directory3`

    `root@ubuntu20s1:~/directory5/directory3# pwd`

    `/root/directory5/directory3`

    `root@ubuntu20s1:~/directory5/directory3# cd`

    `/root/directory4/directory2`

    `root@ubuntu20s1:~/directory4/directory2# pwd`

    `/root/directory4/directory2`

5.  `cd ~`也可用于返回用户的主目录。

    `root@ubuntu20s1:~# cd /root/directory4/directory2`

    `root@ubuntu20s1:~/directory4/directory2# pwd`

    `/root/directory4/directory2`

    `root@ubuntu20s1:~/directory4/directory2# cd ~`

    `root@ubuntu20s1:~# pwd`

    `/root`

6.  与`./`命令不同，`cd ~`还允许您在不依赖于当前工作目录的目录之间跳转。

    `root@ubuntu20s1:~# cd /root/directory4/directory2`

    `root@ubuntu20s1:~/directory4/directory2# pwd`

    `/root/directory4/directory2`

    `root@ubuntu20s1:~/directory4/directory2# cd ~/directory5/directory3`

    `root@ubuntu20s1:~/directory5/directory3# pwd`

    `/root/directory5/directory3`

7.  `dir`(目录)命令与`ls –C –b`命令相同，据说 Linux 和 Windows 用户都包括了这个命令。不同的是，当你使用`dir`时，目录名是黑色的，但是使用`ls –C –b`会返回彩色的目录名。

    `root@ubuntu20s1:~# dir`

    `Desktop   directory4 Documents Music   Public Templates`

    `directory1 directory5 Downloads Pictures snap  Videos`

    `root@ubuntu20s1:~# ls -C -b`

    `Desktop   directory4 Documents Music   Public Templates`

    `directory1 directory5 Downloads Pictures snap  Videos`

8.  `touch`命令用于创建一个文件。如果您输入如下所示的`touch file_name`，将会创建一个文件。你也可以用一个`touch`命令创建多个文件。

    `root@ubuntu20s1:~# touch myfile02.txt`

    `root@ubuntu20s1:~# ls myfile*`

    `myfile02.txt`

    `root@ubuntu20s1:~# touch myfile03.txt myfile04.txt`

    `root@ubuntu20s1:~# ls myfile*`

    `myfile02.txt myfile03.txt myfile04.txt`

9.  `cp`(复制)命令允许你复制文件或目录。复制目录时不要忘记使用`–r`(递归)选项。

    `root@ubuntu20s1:~# ls myfile*`

    `myfile02.txt myfile03.txt myfile04.txt`

    `root@ubuntu20s1:~# cp myfile03.txt myfile05.txt`

    `root@ubuntu20s1:~# ls myfile*`

    `myfile02.txt myfile03.txt myfile04.txt myfile05.txt`

    `root@ubuntu20s1:~# ls -d directory*`

    `directory1 directory4 directory5`

    `root@ubuntu20s1:~# cp -r directory1 directory2`

    `root@ubuntu20s1:~# ls -d directory*`

    `directory1 directory2 directory4 directory5`

10.  `rm`(删除)可用于删除文件或删除目录。在下面的例子中，将使用`–r`选项删除`directory4`。

    `root@ubuntu20s1:~# ls myfile*`

    `myfile02.txt myfile03.txt myfile04.txt myfile05.txt`

    `root@ubuntu20s1:~# rm myfile02.txt`

    `root@ubuntu20s1:~# ls myfile*`

    `myfile03.txt myfile04.txt myfile05.txt`

    `root@ubuntu20s1:~# rm myfile*`

    `root@ubuntu20s1:~# ls myfile*`

    `ls: cannot access 'myfile*': No such file or directory`

    `root@ubuntu20s1:~# tree directory*`

    `directory1`

    `directory2`

    `directory4`

    ε──t0″

    `directory5`

    ■t0]

    ε──t0″

    `2 directories, 1 file`

    `root@ubuntu20s1:~# rm -r directory4`

    `root@ubuntu20s1:~# tree directory*`

    `directory1`

    `directory2`

    `directory5`

    ■t0]

    ε──t0″

    `1 directory, 1 file`

#### 练习 7-3

1.  `mv` (move)命令允许您更改文件名或将文件和目录移动到另一个目录。让我们通过一些例子来了解这一点。

    `# Rename myfile01.txt in root/directory5 to yourfile01.txt.`

    `root@ubuntu20s1:~# ls ./directory5/`

    `directory3 myfile01.txt`

    `root@ubuntu20s1:~# mv ./directory5/myfile01.txt ./directory5/yourfile01.txt`

    `root@ubuntu20s1:~# ls ./directory5/`

    `directory3 yourfile01.txt`

    `# Move yourfile01.txt to /root directory.`

    `root@ubuntu20s1:~# mv ./directory5/yourfile01.txt ./`

    `root@ubuntu20s1:~# ls ./directory5/`

    `directory3`

    `root@ubuntu20s1:~# pwd`

    `/root`

    `root@ubuntu20s1:~# ls your*`

    `yourfile01.txt`

2.  现在我们把`directory5`改名为`directory4`。然后把`directory2`套在`directory3`里面，再把`directory1`套进`directory2`。

    `root@ubuntu20s1:~# mv directory5 directory4`

    `root@ubuntu20s1:~# tree directory*`

    `directory1`

    `directory2`

    `directory4`

    ε──t0″

    `1 directory, 0 files`

    `root@ubuntu20s1:~# mv directory2 ./directory4/directory3/`

    `root@ubuntu20s1:~# mv directory1 ./directory4/directory3/directory2/`

    `root@ubuntu20s1:~# tree directory*`

    `directory4`

    ε──t0″

    ε──t0″

    ε──t0″

    `3 directories, 0 files`

3.  现在使用`.`(点号)方法，让我们将`directory1`、`directory2`和`directory3`移动到根用户的文件夹，与父目录`directory4.`在同一层

    `root@ubuntu20s1:~# tree directory*`

    `directory4`

    ε──t0″

    ε──t0″

    ε──t0″

    `3 directories, 0 files`

    `root@ubuntu20s1:~# mv ./directory4/directory3/directory2/directory1 .`

    `root@ubuntu20s1:~# mv ./directory4/directory3/directory2 .`

    `root@ubuntu20s1:~# mv ./directory4/directory3 .`

    `root@ubuntu20s1:~# tree directory*`

    `directory1`

    `directory2`

    `directory3`

    `directory4`

4.  现在让我们使用`rm`和`rm –r`命令来清理文件和目录以重置时钟。在本练习中，我们要删除一个文本文件和四个目录。

    `root@ubuntu20s1:~# rm yourfile01.txt`

    `oot@ubuntu20s1:~# ls -d directory*`

    `directory1 directory2 directory3 directory4`

    `root@ubuntu20s1:~# rm -r directory*`

    `root@ubuntu20s1:~# ls -d directory*`

    `ls: cannot access 'directory*': No such file or directory`

5.  用您的名字和一个`secrete`密码创建`mysecrete`文件。使用`.`(点)方法创建一个隐藏目录`hideme`，并将`secrete`文件移动到`.hideme`目录中。要查看隐藏文件，使用带有`ls`命令的`–a`选项。

    `root@ubuntu20s1:~# nano mysecrete`

    `root@ubuntu20s1:~# cat mysecrete`

    `pynetauto`

    `fairdinkum`

    `root@ubuntu20s1:~# ls my*`

    `mysecrete`

    `root@ubuntu20s1:~# mkdir .hideme`

    `root@ubuntu20s1:~# ls`

    `Desktop Documents Downloads Music Pictures Public snap Templates Videos`

    `root@ubuntu20s1:~# ls -a`

    `.       .bashrc Desktop  .gnupg  Music   Public Templates`

    `..       .cache  Documents .hideme Pictures snap  Videos`

    `.bash_history .config Downloads .local  .profile .ssh`

    `root@ubuntu20s1:~# mv mysecrete .hideme`

    `root@ubuntu20s1:~# ls .hideme`

    `mysecrete`

    `root@ubuntu20s1:~# ls`

    `Desktop Documents Downloads Music Pictures Public snap Templates Videos`

    `root@ubuntu20s1:~# tree .hideme`

    `.hideme`

    ε──t0″

    `0 directories, 1 file`

如何查看命令选项？

您可以使用`--help`或`man`命令。以下示例显示了`ls --help`和`man ls`命令:

`root@ubuntu20s1:~# ls --help`

`root@ubuntu20s1:~# man ls`

还有，快速搜索 *Linux 命令备忘单*这几个字，Google 会返回上百个搜索结果。这里列出了一个这样的站点供您参考:

[`https://cheatography.com/davechild/cheat-sheets/linux-command-line/`](https://cheatography.com/davechild/cheat-sheets/linux-command-line/)

#### Linux 文件和目录练习 7-2

您刚刚完成了练习 7-1 中的一个基本 Linux 文件和目录练习。接下来，让我们学习更多的命令。用户友好的 GUI 通常是 enterprise Linux 系统中缺少的功能，管理员的许多任务都是通过命令行或控制台界面来执行的。

您的 Linux 学习成功与否取决于您使用基本的文件和目录命令处理文件和目录的能力。

#### 回声，猫，多，少指挥演习

1.  创建一个名为`greet01`的新文件，使用`echo`命令写一个问题，“你能用不同的语言打招呼吗？”进入`greet01`文件。

    `root@ubuntu20s1:~# touch greet01`

    `root@ubuntu20s1:~# ls greet*`

    `greet01`

    `root@ubuntu20s1:~# echo "Can you say Hello in different languages?" > greet01`

    `root@ubuntu20s1:~# more greet01`

    `Can you say Hello in different languages?`

2.  创建另一个名为`greet02`的文件。这一次用各种语言编写`Hello`，并再次使用`echo`命令写入文件。在这个练习中，你将学习如何用十种不同的语言说“嗨”。

    `root@ubuntu20s1:~# touch greet02`

    `root@ubuntu20s1:~# echo "Hi Bonjour Nihao Konichiwa Shalom Merhaba Ola Namaste Ciao Anyoung" > greet02`

    `root@ubuntu20s1:~# cat greet02`

    `Hi Bonjour Nihao Konichiwa Shalom Merhaba Ola Namaste Ciao Anyoung`

3.  在之前的练习中，`cat`命令用于显示`greet02`的内容。`cat`命令的另一个用途是将多个文件合并成一个文件。在这里，您将合并`greet01`和`greet02`并创建`greet03`文件。

    `root@ubuntu20s1:~# cat greet01 greet02 > greet03`

    `root@ubuntu20s1:~# ls -d greet*`

    `greet01 greet02 greet03`

    `root@ubuntu20s1:~# more greet03`

    `Can you say Hello in different languages?`

    `Hi Bonjour Nihao Konichiwa Shalom Merhaba Ola Namaste Ciao Anyoung`

4.  如果你想给同一个文件添加更多的内容，使用`cat >>`命令。

    `root@ubuntu20s1:~# cat >> greet03`

    `How do you say "Love" in different languages?`

    `Love Amour Ai Ai Ahaba Ask Amor Amore Mohabbat Sarang`

    `#To exit, press Ctrl+D keys.`

    `root@ubuntu20s1:~# more greet03`

    `Can you say Hello in different languages?`

    `Hi Bonjour Nihao Konichiwa Shalom Merhaba Ola Namaste Anyoung`

    `How do you say "Love" in different languages?`

    `Love Amour Ai Ai Ahaba Ask Amor Amore Mohabbat Sarang`

5.  您也可以使用`cat >`命令创建一个新文件。

    `root@ubuntu20s1:~# cat > greet04`

    `This is a test file created with the "cat >" command.`

    `You can write something meaningful or anything you like.`

    `#To exit, press Ctrl+D keys` `.`

    `root@ubuntu20s1:~# cat greet04`

    `This is a test file created with "cat >" command.`

    你可以写一些有意义的东西或者任何你喜欢的东西。

6.  您还可以使用更多命令来查看文件内容。如果文件很长，使用空格键向下滚动页面，或使用 Enter 键逐行向下滚动。如果您想在阅读过程中退出，请使用 Ctrl+C 或 Ctrl+Z 键。

    `root@ubuntu20s1:~# more greet03`

    `Can you say Hello in different languages?`

    `Hi Bonjour Nihao Konichiwa Shalom Merhaba Ola Namaste Anyoung`

    `How do you say "Love" in different languages?`

    `Love Amour Ai Ai Ahaba Ask Amor Amore Mohabbat Sarang`

7.  您也可以使用`less`命令来查看文件的内容，但是`less`命令不会在终端上打印内容。若要向下滚动页面，请使用空格键；若要逐行向下滚动，请使用 Enter 键。要退出，使用 Ctrl+Z(或 Ctrl+C，然后是`:q`)。

    `root@ubuntu20s1:~# less greet03`

    `Can you say Hello in different languages?`

    `Hi Bonjour Nihao Konichiwa Shalom Merhaba Ola Namaste Anyoung`

    `How do you say "Love" in different languages` `?`

    `Love Amour Ai Ai Ahaba Ask Amor Amore Mohabbat Sarang`

    `greet03 (END)`

哪里可以找到最好的 Linux 学习资料？

通常，生活中最好的东西都是免费的。感谢 Paul Cobbaut 在 Linuxfun 网站上分享了他的书 *Linux Fundamentals* ，更多的人可以享受 Linux 带来的乐趣。我强烈推荐你下载这个免费的 PDF 文件，并把它用在你的优势上。

UR:[`Linux-training . be/Linux fun . pdf`](https://linux-training.be/linuxfun.pdf)

#### 带选项的 ls 命令

您可能会想，钻研这些练习似乎离您想要将 Python 网络自动化带到哪里的目标太远了。但是你必须做练习，一次打下一块砖来建立一个坚实的基础。所以，这就是建立强大基础的过程。尝试从章节练习中获得尽可能多的实践，并在线和离线使用其他外部 Linux 命令学习材料。

`ls`枚举文件和目录。

`ls –l`显示文件和目录的详细信息。

`ls –a`列出当前工作目录下的所有文件。

`ls –al`显示当前工作目录中文件和目录的详细信息。

1.  使用带有关键字`search`和全包或贪婪`*.`的`ls`命令。以下示例列出了当前工作目录中以单词`greet`开头的所有文件或文件夹。

    `root@ubuntu20s1:~# ls greet*`

    `greet01 greet02 greet03 greet04`

2.  创建一个名为`greetings`的新目录，运行带有`–d`和`–l`(列表)选项的`ls`命令，比较文件和目录之间的差异。在问候目录的开头，注意到了`d`这封信。这表明这是一个目录。

    `root@ubuntu20s1:~# mkdir greetings`

    `root@ubuntu20s1:~# ls -d -l greet*`

    `-rw-r--r-- 1 root root  42 Jun 3 11:45 greet01`

    `-rw-r--r-- 1 root root  62 Jun 3 11:51 greet02`

    `-rw-r--r-- 1 root root 204 Jun 3 12:10 greet03`

    `-rw-r--r-- 1 root root 106 Jun 3 12:15 greet04`

    `drwxr-xr-x 2 root root 4096 Jun 3 12:35 greetings`

3.  此`–a`命令列出所有文件，包括隐藏文件。隐藏文件以`.`(点)开头。

    `root@ubuntu20s1:~# ls -a`

    `.       .cache   Downloads greet03  .local  Public   test01`

    `..       .config  .gnupg   greet04  Music   snap    Videos`

    `.bash_history Desktop  greet01  greetings Pictures .ssh`

    `.bashrc    Documents greet02  .hideme  .profile Templates`

4.  您可以组合各种`ls`选项来列出您喜欢的文件和目录。其他选项有`–R`、`-o`、`-g`、`-i`、`-s`、`-t`、`-S`、`-r`。如果你有一个小时的时间来探索这些选项，请上网花一两个小时找到每一个选项，然后混合搭配。以下是`–l`(列表)和`–h`(人类可读)命令的组合使用:

    `root@ubuntu20s1:~# ls -lh greet*`

    `-rw-r--r-- 1 root root  42 Jun 3 11:45 greet01`

    `-rw-r--r-- 1 root root  62 Jun 3 11:51 greet02`

    `-rw-r--r-- 1 root root 204 Jun 3 12:10 greet03`

    `-rw-r--r-- 1 root root 106 Jun 3 12:15 greet04`

    `greetings` `:`

    `total 0`

#### 一次删除文件和目录

1.  如果您想删除目录中以相同名称开头的所有文件，可以使用`rm filename *.`如果您想删除目录中的所有文件，可以使用`*.`继续上一个练习，让我们将所有以单词`greet`开头的文件移动到`greetings`目录中。

    `roroot@ubuntu20s1:~# pwd`

    `/root`

    `root@ubuntu20s1:~# ls`

    `Desktop  Downloads greet02 greet04  Music   Public Templates Videos`

    `Documents greet01  greet03 greetings Pictures snap  test01`

    `root@ubuntu20s1:~# ls -lh greet*`

    `-rw-r--r-- 1 root root  42 Jun 3 11:45 greet01`

    `-rw-r--r-- 1 root root  62 Jun 3 11:51 greet02`

    `-rw-r--r-- 1 root root 204 Jun 3 12:10 greet03`

    `-rw-r--r-- 1 root root 106 Jun 3 12:15 greet04`

    `greetings:`

    `total 0`

    `root@ubuntu20s1:~# mv ./greet0* ./greetings`

    `root@ubuntu20s1:~# ls`

    `Desktop  Downloads Music   Public Templates Videos`

    `Documents greetings Pictures snap  test01`

    `root@ubuntu20s1:~# ls ./greetings`

    `greet01 greet02 greet03 greet04`

    让我们创建另外四个名为 by01–by04 的文件。

    `root@ubuntu20s1:~# cd greetings`

    `root@ubuntu20s1:~/greetings# touch bye01 bye02 bye03 bye04`

    `root@ubuntu20s1:~/greetings# ls`

    `bye01 bye02 bye03 bye04 greet01 greet02 greet03 greet04`

    现在让我们再检查一次`greetings`目录中的文件，删除包含特定字符串的文件；我们的目标是以 04 结尾的文件。`*`是替换所有字符的通配符。

    `root@ubuntu20s1:~/greetings# ls`

    `bye01 bye02 bye03 bye04 greet01 greet02 greet03 greet04`

    `root@ubuntu20s1:~/greetings# find . -name "*04"`

    `./bye04`

    `./greet04`

    `root@ubuntu20s1:~/greetings# rm *04`

    `root@ubuntu20s1:~/greetings# ls`

    `bye01 bye02 bye03 greet01 greet02 greet03`

    接下来，让我们使用`rm greet*`句柄删除所有包含`greet`的文件。

    `root@ubuntu20s1:~/greetings# rm greet*`

    `root@ubuntu20s1:~/greetings# ls`

    `bye01 bye02 bye03`

    然后，让我们使用`rm *`选项清除文件夹中的所有文件。在这个命令之后，目录应该是空的。

    `root@ubuntu20s1:~/greetings# rm *`

    `root@ubuntu20s1:~/greetings# ls`

    `root@ubuntu20s1:~/greetings#`

2.  如果想用同样的方法删除目录，就得用`rm –r`。`–r`代表递归；如果你不使用`–r`选项，Linux 不允许你删除目录，但是你必须小心使用它。从同一个目录开始，让我们在它下面创建两个目录，并使用`*`通配符来删除包含特定字符串的目录。要删除包含`hi`的目录，您将使用一个双通配符，一个在前面，一个在后面。在本练习结束时，您的目录应该是空的。

    `root@ubuntu20s1:~/greetings# mkdir sayhi01 sayhi02 saybye01 saybye02`

    `root@ubuntu20s1:~/greetings# ls`

    `saybye01 saybye02 sayhi01 sayhi02`

    `root@ubuntu20s1:~/greetings# rm *hi*`

    `rm: cannot remove 'sayhi01': Is a directory`

    `rm: cannot remove 'sayhi02': Is a directory`

    `root@ubuntu20s1:~/greetings# rm -r *hi*`

    `root@ubuntu20s1:~/greetings# ls`

    `saybye01 saybye02`

    `root@ubuntu20s1:~/greetings# rm -r saybye*`

    `root@ubuntu20s1:~/greetings# ls`

    `root@ubuntu20s1:~/greetings#`

#### 创建一个 Python 应用，使您的文件可执行，添加一个 Shebang，然后运行该应用

您可以使用`chmod`命令更改文件的权限。当更改 Python 脚本文件的属性以使其可执行时，这个 Linux 命令非常方便。根用户目录中当前没有 Python 文件。让我们快速创建一个简单的 Python 脚本，并看看如何使用 Python 脚本:

1.  要在 Linux 上创建 Python 脚本，请在文件名末尾添加一个`.py`文件扩展名。要创建你的 Python 脚本，按照我们在 4.4.2.1 章节中学到的`echo`和`cat`命令，或者简单地使用你在本章中学到的 vi 或 nano 文本编辑器。单词 *Automation* 后面的`\n`表示换行符，增加/改变行。创建这个文件并使用`python3 print5times.py`运行应用，以验证您的脚本运行顺利。

    `root@ubuntu20s1:~/myscript# echo "x = 'Python Network Automation\n'" > print5times.py`

    `root@ubuntu20s1:~/myscript# more print5times.py`

    `x = 'Python Network Automation\n'`

    `root@ubuntu20s1:~/myscript# cat >> print5times.py`

    `print(x*5)`

    `#To exit, press Ctrl+D keys.`

    `root@ubuntu20s1:~/myscript# more print5times.py`

    `x = 'Python Network Automation\n'`

    `print(x*5)`

    `root@ubuntu20s1:~/myscript# python3 print5times.py`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

2.  现在我们已经创建了一个工作的 Python 脚本(或应用),并查看了文件模式。是的，这个文件也可以被称为一个*应用*，因为它是一个在你每次运行时打印五次`x`的应用。

    运行`ls –l print5times.py`查看访问。您必须查看以`-rw-r--r--.`开始的结果，如您所见，它缺少了`x`，或可执行级访问。您需要修改这个文件的属性以包含`x`来使这个文件成为一个可执行文件，这样我们就可以在不将 Python 3 指定为应用的情况下运行应用。

    `root@ubuntu20s1:~/myscript# ls -l print5times.py`

    `-rw-r--r-- 1 root root 43 Jun 6 10:42 print5times.py`

    `root@ubuntu20s1:~/myscript# ./print5times.py`

    `-bash: ./print5times.py: Permission denied`

    使用`chmod +x print5times.py`使脚本可执行。文件颜色应该自动变为绿色，表明这是一个可执行文件。

    `root@ubuntu20s1:~/myscript# chmod +x print5times.py`

    `root@ubuntu20s1:~/myscript# ls -l print5times.py`

    `-rwxr-xr-x 1 root root 45 Jun 6 10:46 print5times.py`

    尝试在没有`python3`命令的情况下运行应用。但是当你运行脚本时，你会遇到如下意外的 token 错误，因为我们忘记了在顶部添加臭名昭著的 shebang ( `#!/usr/bin/python3`)行；shebang 线定义了解释器的位置。

    `root@ubuntu20s1:~/myscript# ./print5times.py`

    `./print5times.py: line 1: x: command not found`

    `./print5times.py: line 2: syntax error near unexpected token `x*5'`

    `./print5times.py: line 2: `print(x*5)'`

3.  让我们在脚本的开头加上`#!/usr/bin/python3` (shebang)。这一次，我们将使用带有`–I`和`–e`选项的`sed`命令。Sed 或流编辑器也是一个强大的 Linux/Unix 文本操作工具。你不必 100%熟悉这个工具，但是只要知道它是如何工作的，总有一天它会派上用场。

    `root@ubuntu20s1:~/myscript# cat print5times.py`

    `x = "Python Network Automation\n"`

    `print(x*5)`

    `root@ubuntu20s1:~/myscript# sed -i -e '1i#!/usr/bin/python3\' print5times.py`

    `root@ubuntu20s1:~/myscript# cat print5times.py`

    `#!/usr/bin/python3`

    `x = "Python Network Automation\n"`

    `print(x*5)`

    现在我们检查了 shebang 行在第一行，让我们从工作目录运行 Python 脚本。它应该打印`x`五次，如下所示:

    `root@ubuntu20s1:~/myscript# ./print5times.py`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

4.  如果您想在没有`./?`的情况下运行应用，该怎么办？您可以使用 Linux 命令`PATH="$(pwd):$PATH"`，但是一旦您的 Linux 终端会话结束，添加的路径就会消失。

    `root@ubuntu20s1:~/myscript# ls -lh print5times.py`

    `-rwxr-xr-x 1 root root 64 Jun 6 11:23 print5times.py`

    `root@ubuntu20s1:~/myscript# PATH="$(pwd):$PATH"`

    `root@ubuntu20s1:~/myscript# print5times.py`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

5.  要将`/root/myscript`目录或当前目录永久添加到`PATH`变量中，可以使用下面的命令。现在，即使在您退出会话并返回之后，您应该仍然能够在没有`./`的情况下运行脚本。添加路径后，确保通过执行 source `~/.bashrc`或`exec` bash 命令重启 bash，以使更改生效。

    `root@ubuntu20s1:~/myscript# echo "export PATH=\$PATH:$(pwd)" >> ~/.bashrc`

    `root@ubuntu20s1:~/myscript# exec bash #(source ~/.bashrc) restarts bash`

    `root@ubuntu20s1:~/myscript# print5times.py`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

    `Python Network Automation`

你想学习更多的 Linux 并获得认证吗？

如果你想进一步学习 Linux，你需要学习 Linux 职业学院 101 和红帽的 RHCSA/RHCE。对于那些有空闲时间和金钱的人来说，在线和线下都有很多免费和付费的培训项目。如果您对 LPI 和 RHCE 认证课程感兴趣，请参考以下链接。

Linux 职业学院 URL:

[`https://www.lpi.org/our-certifications/exam-101-objectives`](https://www.lpi.org/our-certifications/exam-101-objectives)

红帽认证系统管理员(RHCSA)网址: [` www。红帽。com/en/services/certification/rhcsa`](https://www.redhat.com/en/services/certification/rhcsa)

红帽认证工程师:

[`https://www.redhat.com/en/services/certification/rhce`](https://www.redhat.com/en/services/certification/rhce)

## 摘要

现在，文件和目录练习就完成了。这里我们只涉及了冰山一角，但是对于您在后面的 Python 网络自动化实验中执行任务来说已经足够了。您必须定期练习 Linux 文件和目录导航，如果不是每天都练习的话，以便习惯它。这就是 Python 网络自动化的神奇之处。

在下一章中，我们将快速介绍一些基本的 Linux 命令来查找重要的 Linux 系统信息。在真实的生产环境中，您将无法幸运地选择您喜欢的 Linux 风格，或者始终拥有对服务器的 root 访问权限。您必须知道如何找到新的 Linux 系统信息，并为您的 Linux 工具、Python 和相关模块找到兼容的软件。